<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PostLineThinnerCorrections.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jacoco Report</a> &gt; <a href="index.source.html" class="el_package">algorithms.imageProcessing</a> &gt; <span class="el_source">PostLineThinnerCorrections.java</span></div><h1>PostLineThinnerCorrections.java</h1><pre class="source lang-java linenums">package algorithms.imageProcessing;

import algorithms.CountingSort;
import algorithms.misc.MiscDebug;
import algorithms.util.CornerArray;
import algorithms.util.PairInt;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashSet;
import java.util.LinkedHashSet;
import java.util.List;
import java.util.Set;
import java.util.logging.Logger;

/**
 *
 * @author nichole
 */
<span class="fc" id="L19">public class PostLineThinnerCorrections {</span>
    
<span class="fc" id="L21">    private Logger log = Logger.getLogger(this.getClass().getName());</span>
    
<span class="fc" id="L23">    protected static final int[] fourNeighborsX = new int[]{0,  1,  0,  -1};</span>
<span class="fc" id="L24">    protected static final int[] fourNeighborsY = new int[]{-1, 0,  1,   0};</span>
    
<span class="fc" id="L26">    protected static final int[] eightNeighborsX = </span>
        new int[]{-1, -1,  0,  1, 1, 1, 0, -1};
<span class="fc" id="L28">    protected static final int[] eightNeighborsY = </span>
        new int[]{ 0, -1, -1, -1, 0, 1, 1,  1};
    
<span class="fc" id="L31">    protected GreyscaleImage edgeGuideImage = null;</span>
    
    public void setEdgeGuideImage(final GreyscaleImage gradientXY) {
<span class="fc" id="L34">        this.edgeGuideImage = gradientXY;</span>
<span class="fc" id="L35">    }</span>
    
    public void correctForArtifacts(GreyscaleImage input) {
           
<span class="fc bfc" id="L39" title="All 2 branches covered.">        if (edgeGuideImage != null) {</span>
<span class="pc bpc" id="L40" title="1 of 2 branches missed.">            if (input.getXRelativeOffset() != edgeGuideImage.getXRelativeOffset()) {</span>
<span class="nc" id="L41">                throw new IllegalStateException(</span>
                    &quot;input and edgeGuideImage must have same x offsets&quot;);
            }
<span class="pc bpc" id="L44" title="1 of 2 branches missed.">            if (input.getYRelativeOffset() != edgeGuideImage.getYRelativeOffset()) {</span>
<span class="nc" id="L45">                throw new IllegalStateException(</span>
                    &quot;input and edgeGuideImage must have same y offsets&quot;);
            }
<span class="pc bpc" id="L48" title="1 of 2 branches missed.">            if (input.getWidth() != edgeGuideImage.getWidth()) {</span>
<span class="nc" id="L49">                throw new IllegalStateException(</span>
                    &quot;input and edgeGuideImage must have same widths&quot;);
            }
<span class="pc bpc" id="L52" title="1 of 2 branches missed.">            if (input.getHeight() != edgeGuideImage.getHeight()) {</span>
<span class="nc" id="L53">                throw new IllegalStateException(</span>
                    &quot;input and edgeGuideImage must have same heights&quot;);
            }
        }
        
<span class="fc" id="L58">        ImageProcessor imageProcessor = new ImageProcessor();</span>
        
<span class="fc" id="L60">        final int w = input.getWidth();</span>
<span class="fc" id="L61">        final int h = input.getHeight();</span>
        
<span class="fc" id="L63">        Set&lt;PairInt&gt; points = imageProcessor.readNonZeroPixels(input);</span>
          
<span class="fc bfc" id="L65" title="All 2 branches covered.">        for (int i = 0; i &lt; 1; i++) {</span>
<span class="fc" id="L66">            straightenLines(points, w, h);</span>
        }
        
<span class="fc" id="L69">        correctForArtifacts(points, w, h);</span>
       
<span class="fc bfc" id="L71" title="All 2 branches covered.">        for (int i = 0; i &lt; 2; i++) {</span>
<span class="fc" id="L72">            straightenLines(points, w, h);</span>
        }
        
<span class="fc" id="L75">        correctForArtifacts(points, w, h);</span>

<span class="fc" id="L77">        imageProcessor.writeAsBinaryToImage(input, points);</span>

<span class="fc" id="L79">    }</span>
 
    public void correctForArtifacts(Set&lt;PairInt&gt; points, int w, int h) {
     
<span class="fc" id="L83">        correctForHoleArtifacts1_2_2(points, w, h);</span>
<span class="fc" id="L84">        correctForHoleArtifacts1_2_3(points, w, h);</span>
        
<span class="fc" id="L86">        correctForSingleHole_01(points, w, h);</span>
<span class="fc" id="L87">        correctForSingleHole_02(points, w, h);</span>
<span class="fc" id="L88">        correctForSingleHole_03(points, w, h);</span>
<span class="fc" id="L89">        correctForSingleHole_04(points, w, h);</span>
<span class="fc" id="L90">        correctForSingleHole_05(points, w, h);</span>
<span class="fc" id="L91">        correctForSingleHole_06(points, w, h);</span>
<span class="fc" id="L92">        correctForSingleHole_07(points, w, h);</span>
<span class="fc" id="L93">        correctForSingleHole_08(points, w, h);</span>
<span class="fc" id="L94">        correctForSingleHole_09(points, w, h);</span>
<span class="fc" id="L95">        correctForSingleHole_10(points, w, h);</span>
<span class="fc" id="L96">        correctForSingleHole_11(points, w, h);</span>
<span class="fc" id="L97">        correctForSingleHole_12(points, w, h);</span>

<span class="fc" id="L99">        correctForZigZag000_00(points, w, h);</span>
<span class="fc" id="L100">        correctForZigZag000_01(points, w, h);</span>
<span class="fc" id="L101">        correctForZigZag000_02(points, w, h);</span>
<span class="fc" id="L102">        correctForZigZag000_03(points, w, h);</span>
        
<span class="fc" id="L104">        correctForZigZag000_04(points, w, h);</span>
<span class="fc" id="L105">        correctForZigZag000_05(points, w, h);</span>
<span class="fc" id="L106">        correctForZigZag000_06(points, w, h);</span>
<span class="fc" id="L107">        correctForZigZag000_07(points, w, h);</span>
<span class="fc" id="L108">        correctForZigZag000_08(points, w, h);</span>
<span class="fc" id="L109">        correctForZigZag000_09(points, w, h);</span>

        //correctForHoleArtifacts1_1(points, w, h);       
<span class="fc" id="L112">        correctForHoleArtifacts1_2(points, w, h);</span>
<span class="fc" id="L113">        correctForHoleArtifacts1_2_1(points, w, h);</span>
<span class="fc" id="L114">        correctForHoleArtifacts1_2_4(points, w, h);</span>
<span class="fc" id="L115">        correctForHoleArtifacts1_2_5(points, w, h);</span>
<span class="fc" id="L116">        correctForHoleArtifacts1_2_6(points, w, h);</span>
<span class="fc" id="L117">        correctForHoleArtifacts1_2_7(points, w, h);</span>
<span class="fc" id="L118">        correctForHoleArtifacts1_3(points, w, h);</span>
        
<span class="fc" id="L120">        correctForZigZag00(points, w, h);</span>
<span class="fc" id="L121">        correctForZigZag00_0(points, w, h);</span>
<span class="fc" id="L122">        correctForZigZag00_0_00(points, w, h);</span>
<span class="fc" id="L123">        correctForZigZag00_0_01(points, w, h);</span>
<span class="fc" id="L124">        correctForZigZag00_0_0(points, w, h);</span>
<span class="fc" id="L125">        correctForZigZag00_0_1(points, w, h);</span>
<span class="fc" id="L126">        correctForZigZag00_0_2(points, w, h);</span>
<span class="fc" id="L127">        correctForZigZag00_1(points, w, h);</span>
<span class="fc" id="L128">        correctForZigZag00_2(points, w, h);</span>
<span class="fc" id="L129">        correctForZigZag00_3(points, w, h);</span>
<span class="fc" id="L130">        correctForZigZag00_5(points, w, h);</span>
<span class="fc" id="L131">        correctForZigZag00_6(points, w, h);</span>
<span class="fc" id="L132">        correctForZigZag00_7(points, w, h);</span>
<span class="fc" id="L133">        correctForZigZag00_8(points, w, h);</span>
<span class="fc" id="L134">        correctForZigZag00_9(points, w, h);</span>
<span class="fc" id="L135">        correctForZigZag00_10(points, w, h);</span>
                
<span class="fc" id="L137">        correctForZigZag00_4(points, w, h);</span>
        
<span class="fc" id="L139">        correctForZigZag00_11(points, w, h);</span>
<span class="fc" id="L140">        correctForZigZag00_12(points, w, h);</span>
<span class="fc" id="L141">        correctForZigZag00_13(points, w, h);</span>
      
<span class="fc" id="L143">        correctForTs(points, w, h);</span>
<span class="fc" id="L144">        correctForTs_0(points, w, h);</span>
<span class="fc" id="L145">        correctForTs_0_1(points, w, h);</span>
<span class="fc" id="L146">        correctForTs_0_2(points, w, h);</span>
<span class="fc" id="L147">        correctForTs_0_3(points, w, h);</span>
<span class="fc" id="L148">        correctForTs_1(points, w, h);</span>
<span class="fc" id="L149">        correctForTs_1_1(points, w, h);</span>
                
        // TODO: revisit, not sure this is always an artifact:
<span class="fc" id="L152">        correctForLine0(points, w, h);</span>
        
        // better edge extraction at the expense of unsharpening true corners:
<span class="fc" id="L155">        correctForLs_0(points, w, h);</span>
<span class="fc" id="L156">        correctForLs_1(points, w, h);        </span>
<span class="fc" id="L157">        correctForLs2_0(points, w, h);</span>
<span class="fc" id="L158">        correctForLs2_1(points, w, h);</span>
        
<span class="fc" id="L160">        correctForZigZag00_14(points, w, h);</span>
<span class="fc" id="L161">        correctForZigZag00_15(points, w, h);</span>
<span class="fc" id="L162">        correctForZigZag00_16(points, w, h);</span>
            
<span class="fc" id="L164">        correctForHoleArtifacts00_10(points, w, h);</span>
        
<span class="fc" id="L166">        correctForZigZag00_0_1(points, w, h);</span>
       
<span class="fc" id="L168">        correctForCorrectionCreatedSquares(points, w, h);</span>
      
<span class="fc" id="L170">        correctForZigZag000_04(points, w, h);</span>
<span class="fc" id="L171">        correctForZigZag000_07(points, w, h);</span>
        
<span class="fc" id="L173">        correctForLs_0(points, w, h);</span>
<span class="fc" id="L174">        correctForLs_1(points, w, h);</span>
<span class="fc" id="L175">        correctForLs_2(points, w, h); </span>
<span class="fc" id="L176">        correctForLs_3(points, w, h);</span>
<span class="fc" id="L177">        correctForLs2_0(points, w, h);</span>
<span class="fc" id="L178">        correctForLs2_1(points, w, h);</span>
        
<span class="fc" id="L180">        correctForTs_0(points, w, h);</span>
<span class="fc" id="L181">        correctForTs_0_1(points, w, h);</span>
<span class="fc" id="L182">        correctForTs_0_2(points, w, h);</span>
<span class="fc" id="L183">        correctForTs_0_3(points, w, h);</span>
<span class="fc" id="L184">        correctForTs_1(points, w, h);</span>
<span class="fc" id="L185">        correctForTs_1_1(points, w, h);</span>
        
<span class="fc" id="L187">        correctForZigZag00_17(points, w, h);</span>
        
<span class="fc" id="L189">        correctForExtCorner(points, w, h);</span>
        
        //correctForRemaining(points, w, h);
<span class="fc" id="L192">    }</span>
        
    private void correctForZigZag00(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
           0  0     #   2
        0  0  #  #      1
        0  #* #  0      0
           #  0  0     -1
        #              -2
       -1  0  1  2  3        
        */
        
<span class="fc" id="L206">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L207">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L208">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L209">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L212">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L213">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L214">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L215">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L217">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L218">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L219">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L220">        ones.add(new PairInt(2, -1));</span>
<span class="fc" id="L221">        ones.add(new PairInt(3, -2));</span>
        
<span class="fc" id="L223">        changeToZeroes.add(new PairInt(0, 0));</span>
<span class="fc" id="L224">        changeToZeroes.add(new PairInt(1, -1));</span>
                    
<span class="fc" id="L226">        int nCorrections = 0;</span>
        
<span class="fc" id="L228">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L231">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L234">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L235">            Integer.toString(nCorrections));</span>
<span class="fc" id="L236">    }</span>
    
    private void correctForZigZag00_0_00(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
                   
        /*       
            0  0  0         2
            #  #  0         1
            0  #* 0         0
            0  #  #        -1
            0  0  0        -2
           -1  0  1  2  3        
        */
        
<span class="fc" id="L250">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L251">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L252">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L253">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L256">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); </span>
<span class="fc" id="L257">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L258">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -2));        </span>
<span class="fc" id="L259">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L260">        zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
                
<span class="fc" id="L262">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L263">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L264">        ones.add(new PairInt(1, 1));</span>
        
<span class="fc" id="L266">        changeToZeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L267">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L269">        int nCorrections = 0;</span>
        
<span class="fc" id="L271">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L274">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>

<span class="fc" id="L276">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L279">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L280">            Integer.toString(nCorrections));</span>
<span class="fc" id="L281">    }</span>
    
    private void correctForZigZag00_0_01(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*       
            0  0  0  #  0     1
            0  #  #* #  0     0
            0  #  0  0  0    -1
           -2 -1  0  1  2   
        */
        
<span class="fc" id="L293">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L294">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L295">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L296">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L299">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L300">        zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L301">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1));        </span>
<span class="fc" id="L302">        zeroes.add(new PairInt(1, 1)); </span>
<span class="fc" id="L303">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
                
<span class="fc" id="L305">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L306">        ones.add(new PairInt(1, 0));  ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L308">        changeToZeroes.add(new PairInt(-1, 0));</span>
<span class="fc" id="L309">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L311">        int nCorrections = 0;</span>
        
<span class="fc" id="L313">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L316">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>

<span class="fc" id="L318">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L321">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L322">            Integer.toString(nCorrections));</span>
<span class="fc" id="L323">    }</span>
    
    private void correctForZigZag00_0(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
               0  0     #   2
               0  #  #      1
            0  #* #  0      0
               #  0  0     -1
               #           -2
           -1  0  1  2  3        
        */
        
<span class="fc" id="L337">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L338">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L339">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L340">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L343">        zeroes.add(new PairInt(-1, 0));</span>
<span class="fc" id="L344">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L345">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L346">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L348">        ones.add(new PairInt(0, 2)); ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L349">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L350">        ones.add(new PairInt(2, -1));</span>
<span class="fc" id="L351">        ones.add(new PairInt(3, -2));</span>
        
<span class="fc" id="L353">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L355">        int nCorrections = 0;</span>
        
<span class="fc" id="L357">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L360">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L363">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L364">            Integer.toString(nCorrections));</span>
<span class="fc" id="L365">    }</span>
    
    private void correctForZigZag00_0_0(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
               0  0         2
               0  #  #  #   1
            0  #* #  0      0
               #  0  0     -1
               #           -2
           -1  0  1  2  3        
        */
<span class="fc" id="L378">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L379">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L380">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L381">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L384">        zeroes.add(new PairInt(-1, 0));</span>
<span class="fc" id="L385">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L386">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L387">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L389">        ones.add(new PairInt(0, 2)); ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L390">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L391">        ones.add(new PairInt(2, -1));</span>
<span class="fc" id="L392">        ones.add(new PairInt(3, -1));</span>
        
<span class="fc" id="L394">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L396">        int nCorrections = 0;</span>
        
<span class="fc" id="L398">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L401">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L404">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L405">            Integer.toString(nCorrections));</span>
<span class="fc" id="L406">    }</span>
    
    private void correctForZigZag00_0_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
               0            2
               0  #  #      1
            0  #* #  0      0
            0  #  0  0     -1
               0           -2
           -1  0  1  2  3        
        */
        
<span class="fc" id="L420">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L421">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L422">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L423">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L426">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0));</span>
<span class="fc" id="L427">        zeroes.add(new PairInt(0, 2));  zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L428">        zeroes.add(new PairInt(1, 1));</span>
<span class="fc" id="L429">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L431">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L432">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L433">        ones.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L435">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L437">        int nCorrections = 0;</span>
        
<span class="fc" id="L439">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L442">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L445">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L446">            Integer.toString(nCorrections));</span>
<span class="fc" id="L447">    }</span>
    
    private void correctForZigZag00_0_2(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
               0  0  0      2
               0  #&lt; #      1
            #  #* #  0      0
            0  #  0        -1
                           -2
           -1  0  1  2  3        
        */
<span class="fc" id="L460">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L461">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L462">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L463">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L466">        zeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L467">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L468">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L469">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L471">        ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L472">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L473">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L474">        ones.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L476">        changeToZeroes.add(new PairInt(1, -1));</span>
                    
<span class="fc" id="L478">        int nCorrections = 0;</span>
        
<span class="fc" id="L480">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L483">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L486">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L487">            Integer.toString(nCorrections));</span>
<span class="fc" id="L488">    }</span>
    
    /**
     * note, this one diminishes corner to make an unambiguous thinned section
     * @param points
     * @param imageWidth
     * @param imageHeight 
     */
    private void correctForRemaining(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
            0  0  0         2
            0  #&lt; #         1
            0  #* 0         0
                           -1
                           -2
           -1  0  1  2  3        
        */
<span class="nc" id="L507">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L508">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L509">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L510">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="nc" id="L513">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="nc" id="L514">        zeroes.add(new PairInt(0, -2));</span>
<span class="nc" id="L515">        zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -2));</span>
        
<span class="nc" id="L517">        ones.add(new PairInt(0, -1)); </span>
<span class="nc" id="L518">        ones.add(new PairInt(1, -1));</span>
        
<span class="nc" id="L520">        changeToZeroes.add(new PairInt(0, -1));</span>
                    
<span class="nc" id="L522">        int nCorrections = 0;</span>
       
<span class="nc" id="L524">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="nc" id="L527">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="nc" id="L530">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="nc" id="L531">            Integer.toString(nCorrections));</span>
<span class="nc" id="L532">    }</span>
    
    private void correctForZigZag00_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                   0  0  #      2
                0  0  #         1
                0  #* #  0      0
                   #  0  0     -1
                #  0  0        -2
        
           -2  -1  0  1  2  3        
        */
        
<span class="fc" id="L547">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L548">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L549">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L550">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L553">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L554">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L555">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L556">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L558">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L559">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L560">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L561">        ones.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L563">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L565">        int nCorrections = 0;</span>
        
<span class="fc" id="L567">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L570">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L573">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L574">            Integer.toString(nCorrections));</span>
<span class="fc" id="L575">    }</span>
    
    private void correctForZigZag00_2(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                   0  0     #   2
                0  0  #  #      1
                0  #* #&lt; 0      0
                #     0  0     -1
             #                 -2
        
            -2 -1  0  1  2  3        
        */
        
<span class="fc" id="L590">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L591">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L592">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L593">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L596">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L597">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L598">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L599">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L601">        ones.add(new PairInt(-2, 2));</span>
<span class="fc" id="L602">        ones.add(new PairInt(-1, 1));</span>
<span class="fc" id="L603">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L604">        ones.add(new PairInt(2, -1));</span>
<span class="fc" id="L605">        ones.add(new PairInt(3, -2));</span>
        
<span class="fc" id="L607">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L609">        int nCorrections = 0;</span>
        
<span class="fc" id="L611">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L614">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L617">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L618">            Integer.toString(nCorrections));</span>
<span class="fc" id="L619">    }</span>
    
    private void correctForZigZag00_3(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             0  0  0  0         2
             #  #  #&lt; 0         1
             0  0  #* #         0
                0  0  0  #     -1
        
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L633">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L634">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L635">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L636">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L639">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L640">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L641">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L642">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L644">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L645">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L646">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L647">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L648">        ones.add(new PairInt(2, 1));</span>
        
<span class="fc" id="L650">        changeToZeroes.add(new PairInt(0, -1));</span>
                    
<span class="fc" id="L652">        int nCorrections = 0;</span>
        
<span class="fc" id="L654">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L657">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L660">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L661">            Integer.toString(nCorrections));</span>
<span class="fc" id="L662">    }</span>
    
    private void correctForZigZag00_11(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  0  0         1
                0  #* #  #      0
                0  0  #  0     -1
            -2 -1  0  1  2  3  
        */
<span class="fc" id="L673">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L674">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L675">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L676">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L679">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L680">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L681">        zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L682">        zeroes.add(new PairInt(2, 1));</span>
        
<span class="fc" id="L684">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L685">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L687">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L689">        int nCorrections = 0;</span>
        
<span class="fc" id="L691">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L694">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L697">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L698">            Integer.toString(nCorrections));</span>
<span class="fc" id="L699">    }</span>
    
    private void correctForZigZag00_12(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
    
        /*       
                0  #  0         1
                0  #* #  #      0
                #  #  0        -1
                0  0  0        -2
            -2 -1  0  1  2  3  
        */
<span class="fc" id="L711">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L712">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L713">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L714">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L717">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L718">        zeroes.add(new PairInt(0, 2));</span>
<span class="fc" id="L719">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L721">        ones.add(new PairInt(-1, 1));</span>
<span class="fc" id="L722">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L723">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L724">        ones.add(new PairInt(2, 0));</span>
 
<span class="fc" id="L726">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L728">        int nCorrections = 0;</span>
        
<span class="fc" id="L730">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L733">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L736">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L737">            Integer.toString(nCorrections));</span>
<span class="fc" id="L738">    }</span>
    
    private void correctForZigZag00_13(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
    
        /*      0  0  0         3
                0  #  0         2
                0  #  #  #      1
             #  #  #* 0         0
             0  #  0  0        -1
             0  0  0           -2
            -2 -1  0  1  2  3  
        */
<span class="fc" id="L751">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L752">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L753">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L754">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L757">        zeroes.add(new PairInt(-2, 2)); zeroes.add(new PairInt(-2, 1));</span>
<span class="fc" id="L758">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L759">        zeroes.add(new PairInt(-1, -2)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L760">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L761">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L762">        zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L764">        ones.add(new PairInt(-2, 0));</span>
<span class="fc" id="L765">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L766">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L767">        ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L768">        ones.add(new PairInt(2, -1));</span>
 
<span class="fc" id="L770">        changeToZeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L771">        changeToZeroes.add(new PairInt(0, -2));</span>
                    
<span class="fc" id="L773">        int nCorrections = 0;</span>
        
<span class="fc" id="L775">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L778">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L781">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L782">            Integer.toString(nCorrections));</span>
<span class="fc" id="L783">    }</span>
    
    private void correctForZigZag00_5(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
          #  0  0  0  0         2
             #  #  #&lt; 0         1
             0  0  #* #         0
                0  0  0  #     -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L797">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L798">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L799">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L800">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L803">        ones.add(new PairInt(-3, -2));</span>
<span class="fc" id="L804">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L805">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L806">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L807">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L809">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L810">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L811">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L812">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L814">        changeToZeroes.add(new PairInt(0, -1));</span>
                    
<span class="fc" id="L816">        int nCorrections = 0;</span>
        
<span class="fc" id="L818">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L821">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L824">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L825">            Integer.toString(nCorrections));</span>
<span class="fc" id="L826">    }</span>
    
    private void correctForZigZag00_6(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             #  0  0  0         2
             0  #  #  0         1
             0  0  #*&lt;#  #      0
                0  0  0  #     -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L840">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L841">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L842">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L843">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L846">        ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L847">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L848">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L849">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L850">        ones.add(new PairInt(2, 1)); ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L852">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L853">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L854">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L855">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L857">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L859">        int nCorrections = 0;</span>
        
<span class="fc" id="L861">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L864">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L867">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L868">            Integer.toString(nCorrections));</span>
<span class="fc" id="L869">    }</span>
    
    private void correctForZigZag00_7(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             #  0  0  0         2
             0  #  #  0         1
             0  0  #*&lt;#  0      0
                0  0  0  #     -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L883">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L884">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L885">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L886">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L889">        ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L890">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L891">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L892">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L893">        ones.add(new PairInt(2, 1));</span>
        
<span class="fc" id="L895">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L896">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L897">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L898">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L899">        zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L901">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L903">        int nCorrections = 0;</span>
        
<span class="fc" id="L905">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L908">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L911">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L912">            Integer.toString(nCorrections));</span>
<span class="fc" id="L913">    }</span>
    
    private void correctForZigZag00_8(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
          #  0  0  0  0         2
             #  #  #&lt; 0  0      1
             0  0  #* #  0      0
                0  0  #  #     -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L927">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L928">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L929">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L930">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L933">        ones.add(new PairInt(-3, -2));</span>
<span class="fc" id="L934">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L935">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L936">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L937">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L938">        ones.add(new PairInt(2, 1));</span>
        
<span class="fc" id="L940">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L941">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L942">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L943">        zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L944">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L946">        changeToZeroes.add(new PairInt(0, -1));</span>
                    
<span class="fc" id="L948">        int nCorrections = 0;</span>
        
<span class="fc" id="L950">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L953">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L956">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L957">            Integer.toString(nCorrections));</span>
<span class="fc" id="L958">    }</span>
    
    private void correctForZigZag00_9(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             #  0  0  0         2
             0  #  #  0  0      1
             0  0  #*&lt;#  #      0
                0  0  0  0     -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L972">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L973">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L974">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L975">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L978">        ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L979">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L980">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L981">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L982">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L984">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L985">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L986">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L987">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L988">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L990">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L992">        int nCorrections = 0;</span>
        
<span class="fc" id="L994">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L997">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1000">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1001">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1002">    }</span>
    
    private void correctForZigZag00_10(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  0            2
             0  0  #  #         1
             0  #&lt; #* 0         0
             #  #  0  0        -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1016">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1017">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1018">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1019">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1022">        ones.add(new PairInt(-2, 1));</span>
<span class="fc" id="L1023">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L1024">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1025">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1027">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L1028">        zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1029">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L1030">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1032">        changeToZeroes.add(new PairInt(-1, 0));</span>
                    
<span class="fc" id="L1034">        int nCorrections = 0;</span>
        
<span class="fc" id="L1036">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1039">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1042">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1043">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1044">    }</span>
    
    private void correctForZigZag000_07(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  0  0         2
                #  #&lt; 0         1
                0  #  #*        0
                0  0  0        -1
            -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1057">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1058">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1059">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1060">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1063">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L1064">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
        
<span class="fc" id="L1066">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L1067">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1068">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L1070">        changeToZeroes.add(new PairInt(-1, -1));</span>
                    
<span class="fc" id="L1072">        int nCorrections = 0;</span>
        
<span class="fc" id="L1074">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1077">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1080">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1081">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1082">    }</span>
    
    private void correctForZigZag000_06(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
           0  0  0        2
           #  #  0  0     1
           0  #&lt; #* 0     0
           0  0  #  0    -1
                         -2
       -3 -2 -1  0  1  2     
        */ 
<span class="fc" id="L1095">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1096">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1097">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1098">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1101">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L1102">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1103">        ones.add(new PairInt(0, 1));</span>
        
<span class="fc" id="L1105">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L1106">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1107">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L1108">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1110">        changeToZeroes.add(new PairInt(-1, 0));</span>
                    
<span class="fc" id="L1112">        int nCorrections = 0;</span>
        
<span class="fc" id="L1114">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1117">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1120">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1121">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1122">    }</span>
    
    private void correctForZigZag000_08(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                #  0  0         1
                #  #*&lt;0         0
                0  #  0        -1
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1135">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1136">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1137">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1138">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1141">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1142">        ones.add(new PairInt(0, 1));</span>
        
<span class="fc" id="L1144">        zeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L1145">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1146">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1148">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1150">        int nCorrections = 0;</span>
        
<span class="fc" id="L1152">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1155">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1158">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1159">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1160">    }</span>
    
    private void correctForZigZag00_14(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  #  0         1
                0  #*&lt;#  0      0
                0  #  #&lt; 0     -1
                #  0  0        -2
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1173">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1174">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1175">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1176">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1179">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L1180">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1181">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1183">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1184">        zeroes.add(new PairInt(0, 2));</span>
<span class="fc" id="L1185">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1186">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1188">        changeToZeroes.add(new PairInt(0, 0));</span>
<span class="fc" id="L1189">        changeToZeroes.add(new PairInt(1, 1));</span>
                    
<span class="fc" id="L1191">        int nCorrections = 0;</span>
        
<span class="fc" id="L1193">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1196">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1199">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1200">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1201">    }</span>
    
    private void correctForZigZag00_15(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                #  0            2
                0  #  0         1
                0  #*&lt;#  0      0
                0  #&lt; #  0     -1
                   0  0  #     -2
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1215">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1216">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1217">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1218">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1221">        ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1222">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1223">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1224">        ones.add(new PairInt(2, 2));</span>
        
<span class="fc" id="L1226">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1227">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L1228">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1229">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1231">        changeToZeroes.add(new PairInt(0, 1));</span>
<span class="fc" id="L1232">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1234">        int nCorrections = 0;</span>
        
<span class="fc" id="L1236">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1239">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1242">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1243">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1244">    }</span>
    
    private void correctForZigZag00_16(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                                2
                0  0  0  #      1
                0  #* #  0      0
             0  #  #&lt; #&lt; 0     -1
             #  0  0  0  0     -2
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1258">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1259">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1260">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1261">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1264">        ones.add(new PairInt(-2, 2));</span>
<span class="fc" id="L1265">        ones.add(new PairInt(-1, 1));</span>
<span class="fc" id="L1266">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1267">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1268">        ones.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1270">        zeroes.add(new PairInt(-2, 1));</span>
<span class="fc" id="L1271">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1272">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1273">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1274">        zeroes.add(new PairInt(2, 2)); zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1276">        changeToZeroes.add(new PairInt(0, 1));</span>
<span class="fc" id="L1277">        changeToZeroes.add(new PairInt(1, 1));</span>
                    
<span class="fc" id="L1279">        int nCorrections = 0;</span>
        
<span class="fc" id="L1281">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1284">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1287">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1288">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1289">    }</span>
    
    private void correctForZigZag00_17(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             0  0  0            2
             0  #  0            1
             #  #  #* #         0
             0  0  #  0        -1
                0  0  0        -2
        
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1304">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1305">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1306">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1307">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1310">        ones.add(new PairInt(-2, 0));</span>
<span class="fc" id="L1311">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1312">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1313">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1315">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, -1)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L1316">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1317">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L1318">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1));</span>
        
<span class="fc" id="L1320">        changeToZeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1321">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L1323">        int nCorrections = 0;</span>
        
<span class="fc" id="L1325">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1328">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1331">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1332">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1333">    }</span>
    
    private void correctForTs(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
          0  0  0  0            2
          #  #  #  0  0  0      1
          0  #&lt; 0  #* #  #      0
          0  0  0  0  #&lt; 0     -1
                   0  0  0     -2
         -3 -2 -1  0  1  2     
        */
        
<span class="fc" id="L1347">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1348">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1349">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1350">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1353">        ones.add(new PairInt(-3, -1));</span>
<span class="fc" id="L1354">        ones.add(new PairInt(-2, 0));ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L1355">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1356">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1357">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1359">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -2));</span>
<span class="fc" id="L1360">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L1361">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1362">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L1363">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1364">        zeroes.add(new PairInt(2, 2)); zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1366">        changeToZeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L1367">        changeToZeroes.add(new PairInt(1, 1));</span>
                    
<span class="fc" id="L1369">        int nCorrections = 0;</span>
        
<span class="fc" id="L1371">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1374">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1377">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1378">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1379">    }</span>
    
    private void correctForTs_0(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             #  0  0  0         1
             0  #  #* #         0
                0  #  0        -1
                0  0  0        -2
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L1392">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1393">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1394">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1395">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1398">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L1399">        ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L1400">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1401">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1403">        zeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L1404">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1405">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1406">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1408">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1410">        int nCorrections = 0;</span>
        
<span class="fc" id="L1412">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1415">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1418">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1419">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1420">    }</span>
    
    private void correctForTs_0_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  0  0  0      1
             #  #  #* #  #      0
                0  #  0        -1
                0  0  0        -2
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L1433">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1434">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1435">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1436">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1439">        ones.add(new PairInt(-2, 0));</span>
<span class="fc" id="L1440">        ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L1441">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1442">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1443">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1445">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1446">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1447">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1448">        zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1450">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L1452">        int nCorrections = 0;</span>
        
<span class="fc" id="L1454">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1457">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1460">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1461">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1462">    }</span>
    
    private void correctForTs_0_2(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  0  0         1
             0  #  #* #         0
             #  0  #  0        -1
                0  0  0        -2
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L1475">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1476">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1477">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1478">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1481">        ones.add(new PairInt(-2, 1));</span>
<span class="fc" id="L1482">        ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L1483">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1484">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1486">        zeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L1487">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1488">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1489">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1491">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L1493">        int nCorrections = 0;</span>
        
<span class="fc" id="L1495">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1498">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1501">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1502">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1503">    }</span>
    
    private void correctForTs_0_3(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
             #  0  0  0         1
             0  #  #* #         0
                0  #  0        -1
                0  #  0        -2
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L1516">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1517">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1518">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1519">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1522">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L1523">        ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L1524">        ones.add(new PairInt(0, 2)); ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1525">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1527">        zeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L1528">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1529">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1530">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1532">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1534">        int nCorrections = 0;</span>
        
<span class="fc" id="L1536">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1539">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1542">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1543">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1544">    }</span>
    
    private void correctForTs_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                                2
                0  #  0  0      1
                0  #* #  0      0
                0  #  0  0     -1
                #  0           -2
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L1558">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1559">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1560">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1561">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1564">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L1565">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1566">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1568">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1569">        zeroes.add(new PairInt(0, 2));</span>
<span class="fc" id="L1570">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1571">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1573">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1575">        int nCorrections = 0;</span>
        
<span class="fc" id="L1577">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1580">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1583">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1584">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1585">    }</span>
    
    private void correctForTs_1_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  #            2
                0  #  0  0      1
                0  #* #  0      0
                0  #  0  0     -1
                0  #           -2
            -2 -1  0  1  2     
        */
        
<span class="fc" id="L1599">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1600">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1601">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1602">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1605">        ones.add(new PairInt(0, 2)); ones.add(new PairInt(0, 1)); </span>
<span class="fc" id="L1606">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L1607">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1609">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); </span>
<span class="fc" id="L1610">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1611">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1612">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1614">        changeToZeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L1616">        int nCorrections = 0;</span>
        
<span class="fc" id="L1618">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L1622">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L1624">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1628">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1629">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1630">    }</span>
    
    private void correctForZigZag00_4(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*       
                0  0  0  #      1
                0  #* #  0      0
                0  #  0  0     -1
                #  0  0        -2
        
           -2  -1  0  1  2  3        
        */
        
<span class="fc" id="L1644">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1645">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1646">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1647">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1650">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1651">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1652">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1653">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1655">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L1656">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1657">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1658">        ones.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1660">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1662">        int nCorrections = 0;</span>
        
<span class="fc" id="L1664">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1667">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1670">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1671">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1672">    }</span>
    
    /**
     * using this one unfortunately reduces the sharpness of real corners,
     * but it allows clear point ordering when extracting edges from the
     * line thinned image.
     */
    protected void correctForLs_0(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*          
        0  #  0         1
        0  #* 0         0
        0  #&lt; #        -1
        0  0  0  #     -2
        
       -1  0  1  2 
        */
        
<span class="fc" id="L1691">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1692">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1693">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1694">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
    
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1697">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); </span>
<span class="fc" id="L1698">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L1699">        zeroes.add(new PairInt(0, 2));</span>
<span class="fc" id="L1700">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1702">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1703">        ones.add(new PairInt(1, 1));</span>
<span class="fc" id="L1704">        ones.add(new PairInt(2, 2));</span>
        
<span class="fc" id="L1706">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L1708">        int nCorrections = 0;</span>
        
<span class="fc" id="L1710">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1713">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1716">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1717">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1718">    }</span>
    
    /**
     * using this one unfortunately reduces the sharpness of real corners,
     * but it allows clear point ordering when extracting edges from the
     * line thinned image.
     */
    protected void correctForLs_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*          
        0  #  0         1
        0  #* 0         0
        0  #&lt; #        -1
        0  0  #        -2
        
       -1  0  1  2 
        */
        
<span class="fc" id="L1737">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1738">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1739">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1740">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
    
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1743">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, 1)); </span>
<span class="fc" id="L1744">        zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L1745">        zeroes.add(new PairInt(0, 2));</span>
<span class="fc" id="L1746">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1748">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1749">        ones.add(new PairInt(1, 1));</span>
<span class="fc" id="L1750">        ones.add(new PairInt(1, 2));</span>
        
<span class="fc" id="L1752">        changeToZeroes.add(new PairInt(0, 1));</span>
                    
<span class="fc" id="L1754">        int nCorrections = 0;</span>
        
<span class="fc" id="L1756">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1759">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1762">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1763">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1764">    }</span>
    
    protected void correctForLs_2(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*          
             0  #  0         1
             0  #* 0  0      0
             0  #  #&lt; 0     -1
             #  0  0  0     -2
          #                 -3
         -2 -1  0  1  2 
        */
        
<span class="fc" id="L1778">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1779">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1780">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1781">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
    
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1784">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L1785">        zeroes.add(new PairInt(0, 2));</span>
<span class="fc" id="L1786">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1787">        zeroes.add(new PairInt(2, 2)); zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); </span>
        
<span class="fc" id="L1789">        ones.add(new PairInt(-2, 3));</span>
<span class="fc" id="L1790">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L1791">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1792">        ones.add(new PairInt(1, 1));</span>
        
<span class="fc" id="L1794">        changeToZeroes.add(new PairInt(1, 1));</span>
                    
<span class="fc" id="L1796">        int nCorrections = 0;</span>
        
<span class="fc" id="L1798">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1801">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1804">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1805">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1806">    }</span>
    
    protected void correctForLs_3(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*          
            0  0  0         1
            0  #* 0         0
            0  #&lt; #  #     -1
            #  0  0  0     -2
         #                 -3       
        -2 -1  0  1  2 
        */
        
<span class="fc" id="L1820">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1821">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1822">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1823">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
    
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1826">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L1827">        zeroes.add(new PairInt(0, 2)); zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1828">        zeroes.add(new PairInt(1, 2)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1829">        zeroes.add(new PairInt(2, 2));</span>
        
<span class="fc" id="L1831">        ones.add(new PairInt(-2, 3));</span>
<span class="fc" id="L1832">        ones.add(new PairInt(-1, 2));</span>
<span class="fc" id="L1833">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1834">        ones.add(new PairInt(1, 1));</span>
<span class="fc" id="L1835">        ones.add(new PairInt(2, 1));</span>
        
<span class="fc" id="L1837">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1839">        int nCorrections = 0;</span>
        
<span class="fc" id="L1841">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1844">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1847">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1848">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1849">    }</span>
    
    protected void correctForLs2_0(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*        
        #               2
        0  #  0  0      1
        0  #*&lt;#  #      0
        0  0  0  0     -1
        
       -1  0  1  2  3
        */
        
<span class="fc" id="L1863">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1864">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1865">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1866">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
   
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1869">        zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L1870">        zeroes.add(new PairInt(0, 1));</span>
<span class="fc" id="L1871">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1872">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1874">        ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L1875">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1876">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1877">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1879">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1881">        int nCorrections = 0;</span>
        
<span class="fc" id="L1883">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1886">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1889">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1890">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1891">    }</span>
    
    protected void correctForLs2_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*        
           #            2
        0  #  0  0      1
        0  #*&lt;#  #      0
        0  0  0  0     -1
        
       -1  0  1  2  3
        */
        
<span class="fc" id="L1905">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1906">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1907">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1908">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
   
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1911">        zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L1912">        zeroes.add(new PairInt(0, 1));</span>
<span class="fc" id="L1913">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L1914">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1916">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L1917">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L1918">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L1919">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L1921">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L1923">        int nCorrections = 0;</span>
        
<span class="fc" id="L1925">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1928">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1931">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1932">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1933">    }</span>
    
    protected void correctForExtCorner(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*        
           0  0  #      2
        0  0  #  0      1
        0  #*&lt;#  0      0
        0  0  0  0     -1
        
       -1  0  1  2  3
        */
        
<span class="fc" id="L1947">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1948">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1949">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1950">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
   
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1953">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, 0)); zeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L1954">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L1955">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L1956">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L1958">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L1959">        ones.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L1961">        changeToZeroes.add(new PairInt(1, 0));</span>
                    
<span class="fc" id="L1963">        int nCorrections = 0;</span>
        
<span class="fc" id="L1965">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1968">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L1971">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L1972">            Integer.toString(nCorrections));</span>
<span class="fc" id="L1973">    }</span>
    
    private void correctForZigZag000_09(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
       
        /*        
            #  0  0         1
            #  #*&lt;0         0
            0  #  #        -1
           -1  0  1  2 
        */
        
<span class="fc" id="L1985">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1986">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1987">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L1988">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
    
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L1991">        zeroes.add(new PairInt(-1, 1));</span>
<span class="fc" id="L1992">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L1993">        zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1995">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L1996">        ones.add(new PairInt(0, 1));</span>
<span class="fc" id="L1997">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L1999">        changeToZeroes.add(new PairInt(0, 0));</span>
                    
<span class="fc" id="L2001">        int nCorrections = 0;</span>
        
<span class="fc" id="L2003">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2006">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2009">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2010">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2011">    }</span>
    
    protected void reverseXs(
        final Set&lt;PairInt&gt; zeroes, final Set&lt;PairInt&gt; ones, 
        Set&lt;PairInt&gt; changeToZeroes, final Set&lt;PairInt&gt; changeToOnes) {
        
        // ----- change the sign of x to handle other direction -----
<span class="fc bfc" id="L2018" title="All 2 branches covered.">        for (PairInt p : zeroes) {</span>
<span class="fc" id="L2019">            p.setX(-1 * p.getX());</span>
<span class="fc" id="L2020">        }</span>
        
<span class="fc bfc" id="L2022" title="All 2 branches covered.">        for (PairInt p : ones) {</span>
<span class="fc" id="L2023">            p.setX(-1 * p.getX());</span>
<span class="fc" id="L2024">        }</span>
          
<span class="fc bfc" id="L2026" title="All 2 branches covered.">        for (PairInt p : changeToZeroes) {</span>
<span class="fc" id="L2027">            p.setX(-1 * p.getX());</span>
<span class="fc" id="L2028">        }</span>
        
<span class="fc bfc" id="L2030" title="All 2 branches covered.">        for (PairInt p : changeToOnes) {</span>
<span class="fc" id="L2031">            p.setX(-1 * p.getX());</span>
<span class="fc" id="L2032">        }</span>
<span class="fc" id="L2033">    }</span>
    
    protected void reverseXs(final Set&lt;PairInt&gt; zeroes, final Set&lt;PairInt&gt; ones) {
        
        // ----- change the sign of x to handle other direction -----
<span class="fc bfc" id="L2038" title="All 2 branches covered.">        for (PairInt p : zeroes) {</span>
<span class="fc" id="L2039">            p.setX(-1 * p.getX());</span>
<span class="fc" id="L2040">        }</span>
        
<span class="fc bfc" id="L2042" title="All 2 branches covered.">        for (PairInt p : ones) {</span>
<span class="fc" id="L2043">            p.setX(-1 * p.getX());</span>
<span class="fc" id="L2044">        }</span>
        
<span class="fc" id="L2046">    }</span>
    
    protected void reverseYs(final Set&lt;PairInt&gt; zeroes, final Set&lt;PairInt&gt; ones, 
        Set&lt;PairInt&gt; changeToZeroes, final Set&lt;PairInt&gt; changeToOnes) {
        
        // ----- change the sign of y  -----
<span class="fc bfc" id="L2052" title="All 2 branches covered.">        for (PairInt p : zeroes) {</span>
<span class="fc" id="L2053">            p.setY(-1 * p.getY());</span>
<span class="fc" id="L2054">        }</span>
        
<span class="fc bfc" id="L2056" title="All 2 branches covered.">        for (PairInt p : ones) {</span>
<span class="fc" id="L2057">            p.setY(-1 * p.getY());</span>
<span class="fc" id="L2058">        }</span>
        
<span class="fc bfc" id="L2060" title="All 2 branches covered.">        for (PairInt p : changeToZeroes) {</span>
<span class="fc" id="L2061">            p.setY(-1 * p.getY());</span>
<span class="fc" id="L2062">        }</span>
        
<span class="fc bfc" id="L2064" title="All 2 branches covered.">        for (PairInt p : changeToOnes) {</span>
<span class="fc" id="L2065">            p.setY(-1 * p.getY());</span>
<span class="fc" id="L2066">        }</span>
        
<span class="fc" id="L2068">    }</span>
    
    protected void reverseYs(final Set&lt;PairInt&gt; zeroes, final Set&lt;PairInt&gt; ones) {
        
        // ----- change the sign of y  -----
<span class="fc bfc" id="L2073" title="All 2 branches covered.">        for (PairInt p : zeroes) {</span>
<span class="fc" id="L2074">            p.setY(-1 * p.getY());</span>
<span class="fc" id="L2075">        }</span>
        
<span class="fc bfc" id="L2077" title="All 2 branches covered.">        for (PairInt p : ones) {</span>
<span class="fc" id="L2078">            p.setY(-1 * p.getY());</span>
<span class="fc" id="L2079">        }</span>
        
<span class="fc" id="L2081">    }</span>
    
    private int rotate90ThreeTimes(
        Set&lt;PairInt&gt; points, int imageWidth, int imageHeight,
        final LinkedHashSet&lt;PairInt&gt; zeroes, final LinkedHashSet&lt;PairInt&gt; ones, 
        LinkedHashSet&lt;PairInt&gt; changeToZeroes, 
        final LinkedHashSet&lt;PairInt&gt; changeToOnes) {
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L2090">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L2092">        int nCorrections = 0;</span>
        
<span class="fc" id="L2094">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
             
        // ----- change the sign of y to handle other direction -----
<span class="fc" id="L2099">        reverseYs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L2101">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle another direction -----
<span class="fc" id="L2106">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
                    
<span class="fc" id="L2108">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2112">        return nCorrections;</span>
    }
    
    private int replacePattern(
        Set&lt;PairInt&gt; points, int imageWidth, int imageHeight,
        final LinkedHashSet&lt;PairInt&gt; zeroes, final LinkedHashSet&lt;PairInt&gt; ones, 
        final LinkedHashSet&lt;PairInt&gt; changeToZeroes, 
        final LinkedHashSet&lt;PairInt&gt; changeToOnes) {
        
<span class="fc" id="L2121">        int w = imageWidth;</span>
<span class="fc" id="L2122">        int h = imageHeight;</span>

<span class="fc" id="L2124">        Set&lt;PairInt&gt; tmpPointsRemoved = new HashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2125">        Set&lt;PairInt&gt; tmpPointsAdded = new HashSet&lt;PairInt&gt;();</span>

<span class="fc bfc" id="L2127" title="All 2 branches covered.">        for (PairInt p : points) {</span>
            
<span class="fc" id="L2129">            boolean isNotPresent = tmpPointsRemoved.contains(p);</span>
<span class="fc bfc" id="L2130" title="All 2 branches covered.">            if (isNotPresent) {</span>
<span class="fc" id="L2131">                continue;</span>
            }
            
<span class="fc" id="L2134">            int col = p.getX();</span>
<span class="fc" id="L2135">            int row = p.getY();           </span>
                
<span class="fc" id="L2137">            boolean foundPattern = true;</span>
           
<span class="fc bfc" id="L2139" title="All 2 branches covered.">            for (PairInt p2 : zeroes) {</span>
<span class="fc" id="L2140">                int x = col + p2.getX();</span>
<span class="fc" id="L2141">                int y = row + p2.getY();</span>
<span class="fc bfc" id="L2142" title="All 8 branches covered.">                if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
                    //TODO: revisit this
<span class="fc" id="L2144">                    foundPattern = false;</span>
<span class="fc" id="L2145">                    break;</span>
                }
<span class="fc" id="L2147">                PairInt p3 = new PairInt(x, y);</span>
<span class="fc bfc" id="L2148" title="All 2 branches covered.">                if (!tmpPointsRemoved.contains(p3)</span>
<span class="fc bfc" id="L2149" title="All 4 branches covered.">                    &amp;&amp; (points.contains(p3) || tmpPointsAdded.contains(p3))) {</span>
<span class="fc" id="L2150">                    foundPattern = false;</span>
              
<span class="fc" id="L2152">                    break;</span>
                }
<span class="fc" id="L2154">            }</span>
               
<span class="fc bfc" id="L2156" title="All 2 branches covered.">            if (!foundPattern) {</span>
<span class="fc" id="L2157">                continue;</span>
            }

<span class="fc bfc" id="L2160" title="All 2 branches covered.">            for (PairInt p2 : ones) {</span>
<span class="fc" id="L2161">                int x = col + p2.getX();</span>
<span class="fc" id="L2162">                int y = row + p2.getY();</span>
<span class="fc bfc" id="L2163" title="All 8 branches covered.">                if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="fc" id="L2164">                    foundPattern = false;</span>
<span class="fc" id="L2165">                    break;</span>
                }
<span class="fc" id="L2167">                PairInt p3 = new PairInt(x, y);</span>
<span class="fc bfc" id="L2168" title="All 2 branches covered.">                if (tmpPointsRemoved.contains(p3) ||</span>
<span class="fc bfc" id="L2169" title="All 4 branches covered.">                    (!points.contains(p3) &amp;&amp; !tmpPointsAdded.contains(p3))) {</span>
<span class="fc" id="L2170">                    foundPattern = false;</span>

<span class="fc" id="L2172">                    break;</span>
                }
<span class="fc" id="L2174">            }</span>
          
<span class="fc bfc" id="L2176" title="All 2 branches covered.">            if (!foundPattern) {</span>
<span class="fc" id="L2177">                continue;</span>
            }
            
<span class="fc bfc" id="L2180" title="All 2 branches covered.">            for (PairInt p2 : changeToZeroes) {</span>
<span class="fc" id="L2181">                int x = col + p2.getX();</span>
<span class="fc" id="L2182">                int y = row + p2.getY();</span>
<span class="pc bpc" id="L2183" title="4 of 8 branches missed.">                if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="nc" id="L2184">                    continue;</span>
                }
<span class="fc" id="L2186">                PairInt p3 = new PairInt(x, y);</span>
<span class="fc" id="L2187">                tmpPointsAdded.remove(p3);                </span>
<span class="fc" id="L2188">                tmpPointsRemoved.add(p3);</span>
<span class="fc" id="L2189">            }</span>

<span class="fc bfc" id="L2191" title="All 2 branches covered.">            for (PairInt p2 : changeToOnes) {</span>
<span class="fc" id="L2192">                int x = col + p2.getX();</span>
<span class="fc" id="L2193">                int y = row + p2.getY();</span>
<span class="pc bpc" id="L2194" title="4 of 8 branches missed.">                if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="nc" id="L2195">                    continue;</span>
                }
<span class="fc" id="L2197">                PairInt p3 = new PairInt(x, y);                </span>
<span class="fc" id="L2198">                tmpPointsRemoved.remove(p3);</span>
<span class="fc" id="L2199">                tmpPointsAdded.add(p3);</span>
<span class="fc" id="L2200">            }</span>
<span class="fc" id="L2201">        }</span>
        
<span class="fc" id="L2203">        int nCorrections = tmpPointsRemoved.size() + tmpPointsAdded.size();</span>
        
<span class="fc bfc" id="L2205" title="All 2 branches covered.">        for (PairInt p2 : tmpPointsRemoved) {</span>
<span class="fc" id="L2206">            points.remove(p2);</span>
<span class="fc" id="L2207">        }</span>
<span class="fc bfc" id="L2208" title="All 2 branches covered.">        for (PairInt p2 : tmpPointsAdded) {</span>
<span class="fc" id="L2209">            points.add(p2);</span>
<span class="fc" id="L2210">        }</span>
        
<span class="fc" id="L2212">        return nCorrections;</span>
    }
    
    /**
     * removes a hole artifact in inclined lines.  note that this should
     * probably be adjusted for gaussian convolution combined radius
     * if used outside of the gradientXY image produced by the
     * CannyEdgeFilter.
     * @param input 
     */
    private void correctForHoleArtifacts3(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*
        looking for pattern
        
            0    0    0    0    0    0           3 4
            0    0    0    0    1    1    1      2 3
            0    0    0    1    0    1    0      1 2
            0    0    1    0*   1    1    0      0 1
            0    1    0    1**  1    0    0     -1 0
            0    1    1    1    0    0    0     -2
            0    1    0    0    0    0    0     -3
        
           -3   -2   -1    0    1    2    3     
        
        and removing the topmost left #'s
        
        */
        
<span class="nc" id="L2242">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L2243">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L2244">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L2245">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="nc" id="L2248">        zeroes.add(new PairInt(-1, -1 - 1));</span>
<span class="nc" id="L2249">        zeroes.add(new PairInt(-1, 1 - 1));</span>
<span class="nc" id="L2250">        zeroes.add(new PairInt(1, -1 - 1));</span>
<span class="nc" id="L2251">        zeroes.add(new PairInt(0, -2 - 1));</span>
<span class="nc" id="L2252">        zeroes.add(new PairInt(1, 2 - 1));</span>
<span class="nc" id="L2253">        zeroes.add(new PairInt(2, 2 - 1)); </span>
<span class="nc" id="L2254">        zeroes.add(new PairInt(2, 1 - 1));</span>
<span class="nc" id="L2255">        zeroes.add(new PairInt(0, -3 - 1));</span>
<span class="nc" id="L2256">        zeroes.add(new PairInt(1, -3 - 1));</span>
<span class="nc" id="L2257">        zeroes.add(new PairInt(-1, -2 - 1));</span>
<span class="nc" id="L2258">        zeroes.add(new PairInt(-1, -3 - 1));</span>
<span class="nc" id="L2259">        zeroes.add(new PairInt(2, -3 - 1));</span>
<span class="nc" id="L2260">        zeroes.add(new PairInt(-2, -3 - 1));</span>
<span class="nc" id="L2261">        zeroes.add(new PairInt(-2, -2 - 1));</span>
<span class="nc" id="L2262">        zeroes.add(new PairInt(-2, -1 - 1));</span>
<span class="nc" id="L2263">        zeroes.add(new PairInt(-2, 0 - 1));</span>
<span class="nc" id="L2264">        zeroes.add(new PairInt(-1, 3 - 1));</span>
<span class="nc" id="L2265">        zeroes.add(new PairInt(0, 3 - 1));</span>
<span class="nc" id="L2266">        zeroes.add(new PairInt(1, 3 - 1));</span>
<span class="nc" id="L2267">        zeroes.add(new PairInt(2, 3 - 1));</span>
<span class="nc" id="L2268">        zeroes.add(new PairInt(3, 3 - 1));</span>
<span class="nc" id="L2269">        zeroes.add(new PairInt(3, 2 - 1));</span>
<span class="nc" id="L2270">        zeroes.add(new PairInt(3, 1 - 1));</span>
<span class="nc" id="L2271">        zeroes.add(new PairInt(3, 0 - 1));</span>
<span class="nc" id="L2272">        zeroes.add(new PairInt(3, -1 - 1));</span>
<span class="nc" id="L2273">        zeroes.add(new PairInt(-3, -3 - 1));</span>
<span class="nc" id="L2274">        zeroes.add(new PairInt(-3, 2 - 1));</span>
<span class="nc" id="L2275">        zeroes.add(new PairInt(-3, -1 - 1));</span>
<span class="nc" id="L2276">        zeroes.add(new PairInt(-3, 0 - 1));</span>
<span class="nc" id="L2277">        zeroes.add(new PairInt(-3, -1 - 1));</span>
<span class="nc" id="L2278">        zeroes.add(new PairInt(-3, -2 - 1));</span>
<span class="nc" id="L2279">        zeroes.add(new PairInt(-3, -3 - 1));</span>
        
<span class="nc" id="L2281">        ones.add(new PairInt(0, 1 - 1));</span>
<span class="nc" id="L2282">        ones.add(new PairInt(0, 2 - 1));</span>
<span class="nc" id="L2283">        ones.add(new PairInt(0, -1 - 1));</span>
<span class="nc" id="L2284">        ones.add(new PairInt(-1, 0 - 1));</span>
<span class="nc" id="L2285">        ones.add(new PairInt(-1, 2 - 1));</span>
<span class="nc" id="L2286">        ones.add(new PairInt(1, -2 - 1));</span>
<span class="nc" id="L2287">        ones.add(new PairInt(1, 0 - 1));</span>
<span class="nc" id="L2288">        ones.add(new PairInt(1, 1 - 1));</span>
<span class="nc" id="L2289">        ones.add(new PairInt(2, -2 - 1));</span>
<span class="nc" id="L2290">        ones.add(new PairInt(2, -1 - 1));</span>
<span class="nc" id="L2291">        ones.add(new PairInt(2, 0 - 1));</span>
<span class="nc" id="L2292">        ones.add(new PairInt(3, -2 - 1));</span>
<span class="nc" id="L2293">        ones.add(new PairInt(-2, 1 - 1));</span>
<span class="nc" id="L2294">        ones.add(new PairInt(-2, 2 - 1));</span>
<span class="nc" id="L2295">        ones.add(new PairInt(-2, 3 - 1));</span>
    
<span class="nc" id="L2297">        changeToZeroes.add(new PairInt(-2, 2 - 1));</span>
<span class="nc" id="L2298">        changeToZeroes.add(new PairInt(-2, 1 - 1));</span>
<span class="nc" id="L2299">        changeToZeroes.add(new PairInt(-1, 0 - 1));</span>
<span class="nc" id="L2300">        changeToZeroes.add(new PairInt(0, -1 - 1));</span>
<span class="nc" id="L2301">        changeToZeroes.add(new PairInt(1, -2 - 1));</span>
<span class="nc" id="L2302">        changeToZeroes.add(new PairInt(2, -2 - 1));</span>
<span class="nc" id="L2303">        changeToZeroes.add(new PairInt(2, 0 - 1));</span>
<span class="nc" id="L2304">        changeToZeroes.add(new PairInt(1, 1 - 1));</span>
<span class="nc" id="L2305">        changeToZeroes.add(new PairInt(0, 2 - 1));</span>
                      
<span class="nc" id="L2307">        int nCorrections = 0;</span>
        
<span class="nc" id="L2309">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="nc" id="L2312">        nCorrections += rotate90ThreeTimes(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
       
<span class="nc" id="L2316">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="nc" id="L2317">            Integer.toString(nCorrections));</span>
<span class="nc" id="L2318">    }</span>
    
    private void correctForLine0(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*
        looking for pattern
       
        0  #  0         2
        0  #  0  0      1
        0  0  #  0      0
        0  #* 0  0     -1
        0  #  0
        
       -1  0  1  2
        
        */
        
<span class="fc" id="L2336">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2337">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2338">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2339">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2342">        zeroes.add(new PairInt(-1, 2 - 1));</span>
<span class="fc" id="L2343">        zeroes.add(new PairInt(-1, 1 - 1));</span>
<span class="fc" id="L2344">        zeroes.add(new PairInt(-1, 0 - 1));</span>
<span class="fc" id="L2345">        zeroes.add(new PairInt(-1, -1 - 1));</span>
<span class="fc" id="L2346">        zeroes.add(new PairInt(-1, -2 - 1));</span>
<span class="fc" id="L2347">        zeroes.add(new PairInt(1, 2 - 1));</span>
<span class="fc" id="L2348">        zeroes.add(new PairInt(1, 1 - 1));</span>
<span class="fc" id="L2349">        zeroes.add(new PairInt(1, -1 - 1));</span>
<span class="fc" id="L2350">        zeroes.add(new PairInt(1, -2 - 1));</span>
<span class="fc" id="L2351">        zeroes.add(new PairInt(2, 1 - 1));</span>
<span class="fc" id="L2352">        zeroes.add(new PairInt(2, 0 - 1));</span>
<span class="fc" id="L2353">        zeroes.add(new PairInt(2, -1 - 1));</span>
        
<span class="fc" id="L2355">        ones.add(new PairInt(0, 2 - 1));</span>
<span class="fc" id="L2356">        ones.add(new PairInt(0, 1 - 1));</span>
<span class="fc" id="L2357">        ones.add(new PairInt(0, -1 - 1));</span>
<span class="fc" id="L2358">        ones.add(new PairInt(0, -2 - 1));</span>
<span class="fc" id="L2359">        ones.add(new PairInt(1, 0 - 1));</span>
        
<span class="fc" id="L2361">        changeToZeroes.add(new PairInt(1, 0 - 1));</span>
<span class="fc" id="L2362">        changeToOnes.add(new PairInt(0, 0 - 1));</span>
                
<span class="fc" id="L2364">        int nCorrections = 0;</span>
        
<span class="fc" id="L2366">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2369">        nCorrections += rotate90ThreeTimes(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2373">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2374">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2375">    }</span>
    
    private void correctForHoleArtifacts1_2(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*     
             0  0              2
          0  0  #  #  #        1
             #  0  0  #        0
             #  #  #* 0  0     -1
                   0  0        -2
        
         -3 -2 -1  0  1  2
        */  

<span class="fc" id="L2390">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2391">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2392">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2393">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2396">        zeroes.add(new PairInt(-3, -1 - 1));</span>
<span class="fc" id="L2397">        zeroes.add(new PairInt(-2, -1 - 1));</span>
<span class="fc" id="L2398">        zeroes.add(new PairInt(-2, -2 - 1));</span>
<span class="fc" id="L2399">        zeroes.add(new PairInt(-1, 0 - 1));</span>
<span class="fc" id="L2400">        zeroes.add(new PairInt(-1, -2 - 1));</span>
<span class="fc" id="L2401">        zeroes.add(new PairInt(0, 2 - 1));</span>
<span class="fc" id="L2402">        zeroes.add(new PairInt(1, 2 - 1));</span>
<span class="fc" id="L2403">        zeroes.add(new PairInt(1, 1 - 1));</span>
<span class="fc" id="L2404">        zeroes.add(new PairInt(2, 1 - 1));</span>
        
<span class="fc" id="L2406">        ones.add(new PairInt(-2, 1 - 1));</span>
<span class="fc" id="L2407">        ones.add(new PairInt(-2, 0 - 1));</span>
<span class="fc" id="L2408">        ones.add(new PairInt(-1, 1 - 1));</span>
<span class="fc" id="L2409">        ones.add(new PairInt(-1, -1 - 1));</span>
<span class="fc" id="L2410">        ones.add(new PairInt(0, 1 - 1));</span>
<span class="fc" id="L2411">        ones.add(new PairInt(0, -1 - 1));</span>
<span class="fc" id="L2412">        ones.add(new PairInt(1, 0 - 1));</span>
<span class="fc" id="L2413">        ones.add(new PairInt(1, -1 - 1));</span>
        
<span class="fc" id="L2415">        changeToZeroes.add(new PairInt(-2, 0 - 1));</span>
<span class="fc" id="L2416">        changeToZeroes.add(new PairInt(-1, -1 - 1));</span>
<span class="fc" id="L2417">        changeToZeroes.add(new PairInt(-1, 1 - 1));</span>
<span class="fc" id="L2418">        changeToZeroes.add(new PairInt(0, 1 - 1));</span>
<span class="fc" id="L2419">        changeToZeroes.add(new PairInt(0, -1 - 1));</span>
<span class="fc" id="L2420">        changeToZeroes.add(new PairInt(1, 0 - 1));</span>
        
<span class="fc" id="L2422">        changeToOnes.add(new PairInt(-1, 0 - 1));</span>
<span class="fc" id="L2423">        changeToOnes.add(new PairInt(0, 0 - 1));</span>
                
<span class="fc" id="L2425">        int nCorrections = 0;</span>
        
<span class="fc" id="L2427">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2430">        nCorrections += rotate90ThreeTimes(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
       
<span class="fc" id="L2434">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2435">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2436">    }</span>
    
    private void correctForHoleArtifacts1_2_1(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*     
                               
                #  #  #        2
             #  0  0  #        1
             #  #  #* #        0
        
         -3 -2 -1  0  1  2
        */  

<span class="fc" id="L2450">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2451">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2454">        ones.add(new PairInt(-2, 0));</span>
<span class="fc" id="L2455">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L2456">        ones.add(new PairInt(-1, 0));</span>
<span class="fc" id="L2457">        ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2458">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L2459">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L2460">        ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L2461">        ones.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L2463">        zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L2464">        zeroes.add(new PairInt(0, -1));        </span>
        
<span class="fc" id="L2466">        int nRotations = 3;</span>
        
<span class="fc" id="L2468">        int nCorrections = replaceAndRotateOnesIfNullable(points, imageWidth, </span>
            imageHeight, zeroes, ones, nRotations);
       
<span class="fc" id="L2471">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2472">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2473">    }</span>
    
    private void correctForHoleArtifacts1_2_4(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*     
                #  #  #        2
             #  0  0  #        1
             #  #  #*          0
        
         -3 -2 -1  0  1  2
        */

<span class="fc" id="L2486">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2487">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0, 0)
<span class="fc" id="L2490">        ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L2491">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2492">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L2493">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L2495">        zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L2496">        zeroes.add(new PairInt(0, -1));</span>
        
<span class="fc" id="L2498">        int nRotations = 1;</span>
        
<span class="fc" id="L2500">        int nCorrections = replaceAndRotateOnesIfNullable(points, imageWidth, </span>
            imageHeight, zeroes, ones, nRotations);
       
<span class="fc" id="L2503">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2504">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2505">    }</span>
    
    private void correctForHoleArtifacts1_2_5(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*     
                #  #  #        2
             #  0  0  #        1
                #  #*          0
        
         -3 -2 -1  0  1  2
        */

<span class="fc" id="L2518">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2519">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0, 0)
<span class="fc" id="L2522">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L2523">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2524">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L2525">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L2527">        zeroes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L2528">        zeroes.add(new PairInt(0, -1));</span>
        
<span class="fc" id="L2530">        int nRotations = 1;</span>
        
<span class="fc" id="L2532">        int nCorrections = replaceAndRotateOnesIfNullable(points, imageWidth, </span>
            imageHeight, zeroes, ones, nRotations);
       
<span class="fc" id="L2535">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2536">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2537">    }</span>
    
    private void correctForHoleArtifacts1_2_6(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*     
                #  #  #        3
                #  0  #        2
                #  0  #        1
                   #* #        0
        
         -3 -2 -1  0  1  2
        */

<span class="fc" id="L2551">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2552">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0, 0)
<span class="fc" id="L2555">        ones.add(new PairInt(-1, -1)); ones.add(new PairInt(-1, -2)); ones.add(new PairInt(-1, -3));</span>
<span class="fc" id="L2556">        ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L2557">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L2558">        ones.add(new PairInt(1, -2)); ones.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L2560">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L2562">        int nRotations = 1;</span>
        
<span class="fc" id="L2564">        int nCorrections = replaceAndRotateOnesIfNullable(points, imageWidth, </span>
            imageHeight, zeroes, ones, nRotations);
       
<span class="fc" id="L2567">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2568">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2569">    }</span>
    
    private void correctForHoleArtifacts1_2_7(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*     
                   #  #        3
                #  0  #        2
                #  0  #        1
                   #* #        0
        
         -3 -2 -1  0  1  2
        */

<span class="fc" id="L2583">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2584">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0, 0)
<span class="fc" id="L2587">        ones.add(new PairInt(-1, -1)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2588">        ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L2589">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L2590">        ones.add(new PairInt(1, -2)); ones.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L2592">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L2594">        int nRotations = 1;</span>
        
<span class="fc" id="L2596">        int nCorrections = replaceAndRotateOnesIfNullable(points, imageWidth, </span>
            imageHeight, zeroes, ones, nRotations);
       
<span class="fc" id="L2599">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2600">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2601">    }</span>
    
    private void correctForHoleArtifacts1_2_2(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*   0  0  0  0  0     4                        4
             0  #  #  #  0     3         .  .  .        3 
             0  #  0  #  #     2         .     #  #     2
             0  #  0  #  0     1         .  @  .        1
             0  #  #* #  0     0         #  .* .        0
                #  0  0  0     -1        #              -1
        
         -3 -2 -1  0  1  2        -3 -2 -1  0  1  2
        */
<span class="fc" id="L2615">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2616">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2617">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2618">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2621">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L2622">        zeroes.add(new PairInt(-2, -2));  zeroes.add(new PairInt(-2, -3)); zeroes.add(new PairInt(-2, -4));</span>
<span class="fc" id="L2623">        zeroes.add(new PairInt(-1, -4));</span>
<span class="fc" id="L2624">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); </span>
<span class="fc" id="L2625">        zeroes.add(new PairInt(0, -2)); zeroes.add(new PairInt(0, -4));</span>
<span class="fc" id="L2626">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -4));</span>
<span class="fc" id="L2627">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
<span class="fc" id="L2628">        zeroes.add(new PairInt(2, -3)); zeroes.add(new PairInt(2, -4));</span>
        
<span class="fc" id="L2630">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L2631">        ones.add(new PairInt(-1, -2)); ones.add(new PairInt(-1, -3));</span>
<span class="fc" id="L2632">        ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L2633">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
<span class="fc" id="L2634">        ones.add(new PairInt(1, -3));</span>
<span class="fc" id="L2635">        ones.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L2637">        changeToOnes.add(new PairInt(0, -1));</span>
        
<span class="fc" id="L2639">        changeToZeroes.add(new PairInt(-1, -1)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2640">        changeToZeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L2641">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L2642">        changeToZeroes.add(new PairInt(1, 0)); changeToZeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L2643">        changeToZeroes.add(new PairInt(1, -3));</span>
                    
<span class="fc" id="L2645">        int nCorrections = 0;</span>
      
<span class="fc" id="L2647">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2650">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
       
<span class="fc" id="L2653">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2654">            Integer.toString(nCorrections));</span>
       
<span class="fc" id="L2656">    }</span>
    
    private void correctForHoleArtifacts1_2_3(Set&lt;PairInt&gt; points, int imageWidth,
        int imageHeight) {
        
        /*                                               
           0  0  0  0  0  0  0     3                                 3
           0  #  #  #  #  #  0     2            .  .  .  .  .        2
           0  #  0  0  0  #  0     1            .     @  @  .        1
           #  #  #  #  #* #  0     0         #  #  #  .  .* .        0
              0  #  0  0  0  0     -1           0  #                 -1

          -4 -3 -2 -1  0  1  2        
        */
<span class="fc" id="L2670">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2671">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2672">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2673">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2676">        zeroes.add(new PairInt(-4, -1)); zeroes.add(new PairInt(-4, -2)); zeroes.add(new PairInt(-4, -3));</span>
<span class="fc" id="L2677">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L2678">        zeroes.add(new PairInt(-2, -1)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L2679">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L2680">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -3)); </span>
<span class="fc" id="L2681">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -3));</span>
<span class="fc" id="L2682">        zeroes.add(new PairInt(2, 1)); zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
<span class="fc" id="L2683">        zeroes.add(new PairInt(2, -2)); zeroes.add(new PairInt(2, -3));</span>
        
<span class="fc" id="L2685">        ones.add(new PairInt(-4, 0)); </span>
<span class="fc" id="L2686">        ones.add(new PairInt(-3, 0)); ones.add(new PairInt(-3, -1)); ones.add(new PairInt(-3, -2));</span>
<span class="fc" id="L2687">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L2688">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2689">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L2690">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
      
<span class="fc" id="L2692">        changeToOnes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L2693">        changeToOnes.add(new PairInt(0, -1));</span>
        
<span class="fc" id="L2695">        changeToZeroes.add(new PairInt(-3, -1)); changeToZeroes.add(new PairInt(-3, -2));</span>
<span class="fc" id="L2696">        changeToZeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L2697">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2698">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L2699">        changeToZeroes.add(new PairInt(1, 0)); changeToZeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L2700">        changeToZeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L2702">        int nCorrections = 0;</span>
        
<span class="fc" id="L2704">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2707">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
       
<span class="fc" id="L2710">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2711">            Integer.toString(nCorrections));</span>
       
<span class="fc" id="L2713">    }</span>
    
    private void correctForHoleArtifacts1_3(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*     
             0  0              2
          0  0  #  #           1
          0  #  0  0&lt; #  0     0
                #  #* 0  0     -1
                   0  0        -2
        
         -3 -2 -1  0  1  2
        */  

<span class="fc" id="L2728">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2729">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2730">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2731">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2734">        zeroes.add(new PairInt(-3, 0 - 1));</span>
<span class="fc" id="L2735">        zeroes.add(new PairInt(-3, -1 - 1));</span>
<span class="fc" id="L2736">        zeroes.add(new PairInt(-2, -1 - 1));</span>
<span class="fc" id="L2737">        zeroes.add(new PairInt(-2, -2 - 1));</span>
<span class="fc" id="L2738">        zeroes.add(new PairInt(-1, 0 - 1));</span>
<span class="fc" id="L2739">        zeroes.add(new PairInt(-1, -2 - 1));</span>
<span class="fc" id="L2740">        zeroes.add(new PairInt(0, 2 - 1));</span>
<span class="fc" id="L2741">        zeroes.add(new PairInt(1, 2 - 1));</span>
<span class="fc" id="L2742">        zeroes.add(new PairInt(1, 1 - 1));</span>
<span class="fc" id="L2743">        zeroes.add(new PairInt(2, 1 - 1));</span>
<span class="fc" id="L2744">        zeroes.add(new PairInt(2, 0 - 1));</span>
        
<span class="fc" id="L2746">        ones.add(new PairInt(-2, 0 - 1));</span>
<span class="fc" id="L2747">        ones.add(new PairInt(-1, 1 - 1));</span>
<span class="fc" id="L2748">        ones.add(new PairInt(-1, -1 - 1));</span>
<span class="fc" id="L2749">        ones.add(new PairInt(0, 1 - 1));</span>
<span class="fc" id="L2750">        ones.add(new PairInt(0, -1 - 1));</span>
<span class="fc" id="L2751">        ones.add(new PairInt(1, 0 - 1));</span>
        
<span class="fc" id="L2753">        changeToZeroes.add(new PairInt(-2, 0 - 1));</span>
<span class="fc" id="L2754">        changeToZeroes.add(new PairInt(-1, -1 - 1));</span>
<span class="fc" id="L2755">        changeToZeroes.add(new PairInt(-1, 1 - 1));</span>
<span class="fc" id="L2756">        changeToZeroes.add(new PairInt(0, -1 - 1));</span>
<span class="fc" id="L2757">        changeToZeroes.add(new PairInt(0, 1 - 1));</span>
<span class="fc" id="L2758">        changeToZeroes.add(new PairInt(1, 0 - 1));</span>
        
<span class="fc" id="L2760">        changeToOnes.add(new PairInt(-2, 1 - 1));</span>
<span class="fc" id="L2761">        changeToOnes.add(new PairInt(-1, 0 - 1));</span>
<span class="fc" id="L2762">        changeToOnes.add(new PairInt(0, 0 - 1));</span>
<span class="fc" id="L2763">        changeToOnes.add(new PairInt(1, -1 - 1));</span>
                    
<span class="fc" id="L2765">        int nCorrections = 0;</span>
        
<span class="fc" id="L2767">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L2770">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
       
<span class="fc" id="L2773">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L2774">            Integer.toString(nCorrections));</span>
<span class="fc" id="L2775">    }</span>

    private int replaceAndRotateOnesIfNullable(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight,
        Set&lt;PairInt&gt; zeroes, Set&lt;PairInt&gt; ones, int nRotations) {
        
<span class="fc" id="L2781">        ErosionFilter erosionFilter = new ErosionFilter();</span>
<span class="fc" id="L2782">        erosionFilter.overrideEndOfLineCheck();</span>
        
<span class="fc" id="L2784">        int w = imageWidth;</span>
<span class="fc" id="L2785">        int h = imageHeight;</span>
        
<span class="fc" id="L2787">        int[] neighborsCount = new int[ones.size()];</span>
<span class="fc" id="L2788">        PairInt[] neighbors = new PairInt[neighborsCount.length];</span>
        
<span class="fc" id="L2790">        int nCorrected = 0;</span>
        
<span class="fc bfc" id="L2792" title="All 2 branches covered.">        for (int nRot = 0; nRot &lt;= nRotations; nRot++) {</span>
       
<span class="fc bfc" id="L2794" title="All 4 branches covered.">            switch(nRot) {</span>
                case 1:
<span class="fc" id="L2796">                    reverseXs(zeroes, ones);</span>
<span class="fc" id="L2797">                    break;</span>
                case 2:
<span class="fc" id="L2799">                    reverseYs(zeroes, ones);</span>
<span class="fc" id="L2800">                    break;</span>
                case 3:
<span class="fc" id="L2802">                    reverseXs(zeroes, ones);</span>
<span class="fc" id="L2803">                    break;</span>
                default:
                    break;
            }
            
<span class="fc" id="L2808">            Set&lt;PairInt&gt; tmpPointsRemoved = new HashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2809">            Set&lt;PairInt&gt; tmpPointsAdded = new HashSet&lt;PairInt&gt;();</span>

<span class="fc bfc" id="L2811" title="All 2 branches covered.">            for (PairInt p : points) {</span>

<span class="fc" id="L2813">                int col = p.getX();</span>
<span class="fc" id="L2814">                int row = p.getY();</span>

                // make sure the current point hasn't been added to tmpPointsRemoved
<span class="fc" id="L2817">                boolean isNotPresent = tmpPointsRemoved.contains(p);</span>
<span class="fc bfc" id="L2818" title="All 2 branches covered.">                if (isNotPresent) {</span>
<span class="fc" id="L2819">                    continue;</span>
                }

<span class="fc" id="L2822">                boolean foundPattern = true;</span>

<span class="fc bfc" id="L2824" title="All 2 branches covered.">                for (PairInt p2 : ones) {</span>
<span class="fc" id="L2825">                    int x = col + p2.getX();</span>
<span class="fc" id="L2826">                    int y = row + p2.getY();</span>
<span class="pc bpc" id="L2827" title="2 of 8 branches missed.">                    if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="fc" id="L2828">                        foundPattern = false;</span>
<span class="fc" id="L2829">                        break;</span>
                    }
<span class="fc" id="L2831">                    PairInt p3 = new PairInt(x, y);</span>
<span class="fc bfc" id="L2832" title="All 2 branches covered.">                    if (tmpPointsRemoved.contains(p3) ||</span>
<span class="fc bfc" id="L2833" title="All 4 branches covered.">                        (!points.contains(p3) &amp;&amp; !tmpPointsAdded.contains(p3))) {</span>
<span class="fc" id="L2834">                        foundPattern = false;</span>
<span class="fc" id="L2835">                        break;</span>
                    }
<span class="fc" id="L2837">                }</span>

<span class="fc bfc" id="L2839" title="All 2 branches covered.">                if (!foundPattern) {</span>
<span class="fc" id="L2840">                    continue;</span>
                }

<span class="fc bfc" id="L2843" title="All 2 branches covered.">                for (PairInt p2 : zeroes) {</span>
<span class="fc" id="L2844">                    int x = col + p2.getX();</span>
<span class="fc" id="L2845">                    int y = row + p2.getY();</span>
<span class="pc bpc" id="L2846" title="4 of 8 branches missed.">                    if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="nc" id="L2847">                        foundPattern = false;</span>
<span class="nc" id="L2848">                        break;</span>
                    }
<span class="fc" id="L2850">                    PairInt p3 = new PairInt(x, y);</span>
<span class="fc bfc" id="L2851" title="All 2 branches covered.">                    if (!tmpPointsRemoved.contains(p3)</span>
<span class="pc bpc" id="L2852" title="1 of 4 branches missed.">                        &amp;&amp; (points.contains(p3) || tmpPointsAdded.contains(p3))) {</span>
<span class="fc" id="L2853">                        foundPattern = false;</span>
<span class="fc" id="L2854">                        break;</span>
                    }
<span class="fc" id="L2856">                }</span>

<span class="fc bfc" id="L2858" title="All 2 branches covered.">                if (!foundPattern) {</span>
<span class="fc" id="L2859">                    continue;</span>
                }
                
                //change the zeroes to ones.  bounds have been checked
<span class="fc bfc" id="L2863" title="All 2 branches covered.">                for (PairInt p2 : zeroes) {</span>
<span class="fc" id="L2864">                    int x = col + p2.getX();</span>
<span class="fc" id="L2865">                    int y = row + p2.getY();</span>
<span class="fc" id="L2866">                    PairInt p3 = new PairInt(x, y);                    </span>
<span class="fc" id="L2867">                    tmpPointsRemoved.remove(p3);</span>
<span class="fc" id="L2868">                    tmpPointsAdded.add(p3);</span>
<span class="fc" id="L2869">                }</span>
               
<span class="fc" id="L2871">                Arrays.fill(neighborsCount, 0);</span>
<span class="fc" id="L2872">                int nIdx = 0;</span>
<span class="fc bfc" id="L2873" title="All 2 branches covered.">                for (PairInt p2 : ones) {</span>
<span class="fc" id="L2874">                    int x1 = col + p2.getX();</span>
<span class="fc" id="L2875">                    int y1 = row + p2.getY();</span>
<span class="fc" id="L2876">                    PairInt p3 = new PairInt(x1, y1);</span>
<span class="fc" id="L2877">                    neighbors[nIdx] = p3;</span>
<span class="fc" id="L2878">                    int count = 0;</span>
<span class="fc bfc" id="L2879" title="All 2 branches covered.">                    for (int n2Idx = 0; n2Idx &lt; eightNeighborsX.length; ++n2Idx) {</span>
<span class="fc" id="L2880">                        int x2 = x1 + eightNeighborsX[n2Idx];</span>
<span class="fc" id="L2881">                        int y2 = y1 + eightNeighborsY[n2Idx];</span>
<span class="pc bpc" id="L2882" title="4 of 8 branches missed.">                        if ((x2 &lt; 0) || (y2 &lt; 0) || (x2 &gt; (w - 1)) || (y2 &gt; (h - 1))) {</span>
<span class="nc" id="L2883">                            continue;</span>
                        }
<span class="fc" id="L2885">                        PairInt p4 = new PairInt(x2, y2);</span>
<span class="fc bfc" id="L2886" title="All 2 branches covered.">                        if (!tmpPointsRemoved.contains(p4)</span>
<span class="fc bfc" id="L2887" title="All 2 branches covered.">                            &amp;&amp; (tmpPointsAdded.contains(p4) || </span>
<span class="fc bfc" id="L2888" title="All 2 branches covered.">                            points.contains(p4))) {</span>
<span class="fc" id="L2889">                            count++;</span>
                        }
                    }
<span class="fc" id="L2892">                    neighborsCount[nIdx] = count;</span>
<span class="fc" id="L2893">                    nIdx++;</span>
<span class="fc" id="L2894">                }</span>
                
<span class="fc" id="L2896">                CountingSort.sort(neighborsCount, neighbors, 8);</span>

<span class="fc bfc" id="L2898" title="All 2 branches covered.">                for (nIdx = 0; nIdx &lt; neighbors.length; ++nIdx) {</span>
                    
<span class="fc" id="L2900">                    PairInt p3 = neighbors[nIdx];</span>
                    
                    // test if can set to 0's without disconnecting lines

                    // adds to tmpPointsRemoved
<span class="fc" id="L2905">                    boolean nullable = erosionFilter.process(p3, points, </span>
                        tmpPointsAdded, tmpPointsRemoved, w, h);
                }
<span class="fc" id="L2908">            }</span>

<span class="fc" id="L2910">            nCorrected += (tmpPointsRemoved.size() + tmpPointsAdded.size());</span>
            
<span class="fc bfc" id="L2912" title="All 2 branches covered.">            for (PairInt p2 : tmpPointsRemoved) {</span>
<span class="fc" id="L2913">                points.remove(p2);</span>
<span class="fc" id="L2914">            }</span>
<span class="fc bfc" id="L2915" title="All 2 branches covered.">            for (PairInt p2 : tmpPointsAdded) {</span>
<span class="fc" id="L2916">                points.add(p2);</span>
<span class="fc" id="L2917">            }</span>
        }
        
<span class="fc" id="L2920">        return nCorrected;</span>
    }

    private void correctForHoleArtifacts1_1(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*     
             0  0  0  0  #     2
             0  #  #  #        1
             0  #  #* 0        0
             0  #  0           -1
             #
         -3 -2 -1  0  1  2
        */  

<span class="nc" id="L2935">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L2936">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L2937">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="nc" id="L2938">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>

        // y's are inverted here because sketch above is top left is (0,0)
<span class="nc" id="L2941">        zeroes.add(new PairInt(-2, 1));</span>
<span class="nc" id="L2942">        zeroes.add(new PairInt(-2, 0));</span>
<span class="nc" id="L2943">        zeroes.add(new PairInt(-2, -1));</span>
<span class="nc" id="L2944">        zeroes.add(new PairInt(-2, -2));</span>
<span class="nc" id="L2945">        zeroes.add(new PairInt(-1, -2));</span>
<span class="nc" id="L2946">        zeroes.add(new PairInt(0, 1));</span>
<span class="nc" id="L2947">        zeroes.add(new PairInt(0, -2));</span>
<span class="nc" id="L2948">        zeroes.add(new PairInt(1, 0));</span>
<span class="nc" id="L2949">        zeroes.add(new PairInt(1, -2));</span>
         
<span class="nc" id="L2951">        ones.add(new PairInt(-2, 2));</span>
<span class="nc" id="L2952">        ones.add(new PairInt(-1, 1));</span>
<span class="nc" id="L2953">        ones.add(new PairInt(-1, 0));</span>
<span class="nc" id="L2954">        ones.add(new PairInt(-1, -1));</span>
<span class="nc" id="L2955">        ones.add(new PairInt(0, -1));</span>
<span class="nc" id="L2956">        ones.add(new PairInt(1, -1));</span>
<span class="nc" id="L2957">        ones.add(new PairInt(2, -2));</span>
        
<span class="nc" id="L2959">        changeToZeroes.add(new PairInt(-1, -1));</span>
<span class="nc" id="L2960">        changeToZeroes.add(new PairInt(-1, 0));</span>
<span class="nc" id="L2961">        changeToZeroes.add(new PairInt(0, -1));</span>
           
<span class="nc" id="L2963">        int nCorrections = 0;</span>
        
<span class="nc" id="L2965">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="nc" id="L2968">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
       
<span class="nc" id="L2971">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="nc" id="L2972">            Integer.toString(nCorrections));</span>
<span class="nc" id="L2973">    }</span>

    private void correctForZigZag000_00(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
        /* diagonal lines on both sides of a narrow cavity are sometimes
           zig-zag and can be thinned in the direction of widening the
           cavity.
                                3                          3
                   0 #          2             0 #          2
                 # # 0 #        1           # . 0 #        1
                 0 # #*0 #      0             # .*0        0
                   0 #         -1               #         -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
<span class="fc" id="L2989">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2990">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2991">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L2992">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L2995">        zeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L2996">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L2997">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L2998">        zeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L3000">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3001">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3002">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3003">        ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L3004">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L3006">        changeToZeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L3007">        changeToZeroes.add(new PairInt(0, 0));</span>
                
<span class="fc" id="L3009">        int nCorrections = 0;</span>
        
<span class="fc" id="L3011">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L3015">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L3017">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3021">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3022">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3023">    }</span>

    private void correctForZigZag000_01(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
        /* diagonal lines on both sides of a narrow cavity are sometimes
           zig-zag and can be thinned in the direction of widening the
           cavity.
                                3                          3
                     # #        2               #          2
                   # 0 # #      1             # 0 .        1
                     #*0 # #    0               #*0 .      0
                       #       -1                 #       -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
<span class="fc" id="L3039">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3040">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3041">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3042">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3045">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L3046">        zeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L3048">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3049">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3050">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
<span class="fc" id="L3051">        ones.add(new PairInt(2, 0)); ones.add(new PairInt(2, -1));</span>
<span class="fc" id="L3052">        ones.add(new PairInt(3, 0));</span>
        
<span class="fc" id="L3054">        changeToZeroes.add(new PairInt(1, -1)); </span>
<span class="fc" id="L3055">        changeToZeroes.add(new PairInt(2, 0));</span>
                
<span class="fc" id="L3057">        int nCorrections = 0;</span>
        
<span class="fc" id="L3059">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L3063">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L3065">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3069">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3070">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3071">    }</span>
    
    private void correctForZigZag000_02(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
        /* diagonal lines on both sides of a narrow cavity are sometimes
           zig-zag and can be thinned in the direction of widening the
           cavity.
                                3                          3
                     # #        2               #          2
                   # 0 # #      1             # 0 .        1
                     #*0 #      0               #*0        0
                       #       -1                 #       -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
<span class="fc" id="L3087">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3088">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3089">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3090">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3093">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L3094">        zeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L3096">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3097">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3098">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
<span class="fc" id="L3099">        ones.add(new PairInt(2, 0)); ones.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L3101">        changeToZeroes.add(new PairInt(1, -1)); </span>
                
<span class="fc" id="L3103">        int nCorrections = 0;</span>
        
<span class="fc" id="L3105">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L3109">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L3111">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3115">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3116">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3117">    }</span>
    
    private void correctForZigZag000_04(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
        /*
                                3                           3
               # 0 0 0          2         # 0 0 0          2
               0 # # 0 0        1         0 # #&lt;0 0        1
                 0 # #*0        0           0 # #&lt;0        0
                     0 0       -1               0 0       -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
<span class="fc" id="L3131">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3132">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3133">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3134">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3137">        zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3138">        zeroes.add(new PairInt(-2, 0)); zeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3139">        zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3140">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L3141">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3143">        ones.add(new PairInt(-3, -2));</span>
<span class="fc" id="L3144">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3145">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
        
<span class="fc" id="L3147">        changeToZeroes.add(new PairInt(0, 0));</span>
<span class="fc" id="L3148">        changeToZeroes.add(new PairInt(-1, -1));</span>
                
<span class="fc" id="L3150">        int nCorrections = 0;</span>
        
<span class="fc" id="L3152">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L3156">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L3158">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3162">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3163">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3164">    }</span>
    
    private void correctForZigZag000_03(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
        /* diagonal lines on both sides of a narrow cavity are sometimes
           zig-zag and can be thinned in the direction of widening the
           cavity.
                                3                          3
                   0 # #        2             0 #          2
                 # # 0 # #      1           # . 0 #        1
                 # # #*0 #      0             # .*0        0
                   # #         -1               #         -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
<span class="fc" id="L3180">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3181">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3182">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3183">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3186">        zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3187">        zeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L3188">        zeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L3190">        ones.add(new PairInt(-2, -1)); ones.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3191">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3192">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3193">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
<span class="fc" id="L3194">        ones.add(new PairInt(2, 0)); ones.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L3196">        changeToZeroes.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L3197">        changeToZeroes.add(new PairInt(0, 0));</span>
                
<span class="fc" id="L3199">        int nCorrections = 0;</span>
        
<span class="fc" id="L3201">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L3205">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L3207">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3211">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3212">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3213">    }</span>

    private void correctForZigZag000_05(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
        /* diagonal lines on both sides of a narrow cavity are sometimes
           zig-zag and can be thinned in the direction of widening the
           cavity.
                                3                          3
                 # 0 0 0        2           #              2
               0 #.# 0 0 0      1           #.#            1
               0 0 #.#*0 0      0             #.#*         0
                 0 0 #         -1               #         -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
<span class="fc" id="L3229">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3230">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3231">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3232">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
        
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3235">        zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3236">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3237">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3238">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L3239">        zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -1)); zeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L3240">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
        
<span class="fc" id="L3242">        ones.add(new PairInt(-2, -1)); ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3243">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3244">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, 0));</span>
        
<span class="fc" id="L3246">        changeToZeroes.add(new PairInt(-2, -1)); </span>
<span class="fc" id="L3247">        changeToZeroes.add(new PairInt(-1, 0));</span>
         
<span class="fc" id="L3249">        int nCorrections = 0;</span>
        
<span class="fc" id="L3251">        nCorrections += replacePattern(points, imageWidth, imageHeight, </span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
        // ----- change the sign of x to handle other direction -----
<span class="fc" id="L3255">        reverseXs(zeroes, ones, changeToZeroes, changeToOnes);</span>
        
<span class="fc" id="L3257">        nCorrections += replacePattern(</span>
            points, imageWidth, imageHeight,
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3261">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3262">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3263">    }</span>
    
    public static int correctForHoleArtifacts00_10(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
<span class="fc" id="L3268">        int w = imageWidth;</span>
<span class="fc" id="L3269">        int h = imageHeight;</span>
        
<span class="fc" id="L3271">        int[] neighborsCount = new int[8];</span>
<span class="fc" id="L3272">        int[] neighborsIdx = new int[8];</span>
        
        /*
                   #         2
                #  0  #      1
                   #*        0
                               
         -3 -2 -1  0  1  2
        */
                
<span class="fc" id="L3282">        Set&lt;PairInt&gt; ones = new HashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3285">        ones.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3286">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3287">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3289">        ErosionFilter erosionFilter = new ErosionFilter();</span>
<span class="fc" id="L3290">        erosionFilter.overrideEndOfLineCheck();</span>
                        
<span class="fc" id="L3292">        Set&lt;PairInt&gt; tmpPointsRemoved = new HashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3293">        Set&lt;PairInt&gt; tmpPointsAdded = new HashSet&lt;PairInt&gt;();</span>

<span class="fc bfc" id="L3295" title="All 2 branches covered.">        for (PairInt p : points) {</span>

<span class="fc" id="L3297">            int col = p.getX();</span>
<span class="fc" id="L3298">            int row = p.getY();</span>

            // make sure the current point hasn't been added to tmpPointsRemoved
<span class="fc" id="L3301">            boolean isNotPresent = tmpPointsRemoved.contains(p);</span>
<span class="fc bfc" id="L3302" title="All 2 branches covered.">            if (isNotPresent) {</span>
<span class="fc" id="L3303">                continue;</span>
            }

<span class="fc" id="L3306">            boolean foundPattern = true;</span>

<span class="fc bfc" id="L3308" title="All 2 branches covered.">            for (PairInt p2 : ones) {</span>
<span class="fc" id="L3309">                int x = col + p2.getX();</span>
<span class="fc" id="L3310">                int y = row + p2.getY();</span>
<span class="pc bpc" id="L3311" title="1 of 8 branches missed.">                if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="fc" id="L3312">                    foundPattern = false;</span>
<span class="fc" id="L3313">                    break;</span>
                }
<span class="fc" id="L3315">                PairInt p3 = new PairInt(x, y);</span>
<span class="fc bfc" id="L3316" title="All 2 branches covered.">                if (tmpPointsRemoved.contains(p3) ||</span>
<span class="fc bfc" id="L3317" title="All 4 branches covered.">                    (!points.contains(p3) &amp;&amp; !tmpPointsAdded.contains(p3))) {</span>
<span class="fc" id="L3318">                    foundPattern = false;</span>
<span class="fc" id="L3319">                    break;</span>
                }
<span class="fc" id="L3321">            }</span>

<span class="fc bfc" id="L3323" title="All 2 branches covered.">            if (!foundPattern) {</span>
<span class="fc" id="L3324">                continue;</span>
            }
            
            /*
            set the center value to zero.
            visit each of the 8 neighbors and count the number of neighbors
            it has.
            sort those by count.
            visit the smallest count neighbors (w/ count &gt; 0) and test
               if nullable.
            */
            
<span class="fc" id="L3336">            int centerRow = row - 1;</span>
            
            // set the center point
<span class="fc" id="L3339">            PairInt p3 = new PairInt(col, centerRow);</span>
<span class="fc" id="L3340">            tmpPointsRemoved.remove(p3);</span>
<span class="fc" id="L3341">            tmpPointsAdded.add(p3);</span>

<span class="fc" id="L3343">            Arrays.fill(neighborsCount, 0);</span>
<span class="fc" id="L3344">            Arrays.fill(neighborsIdx, 0);</span>
<span class="fc bfc" id="L3345" title="All 2 branches covered.">            for (int n1Idx = 0; n1Idx &lt; eightNeighborsX.length; ++n1Idx) {</span>
<span class="fc" id="L3346">                int x1 = col + eightNeighborsX[n1Idx];</span>
<span class="fc" id="L3347">                int y1 = centerRow + eightNeighborsY[n1Idx];                </span>
<span class="fc" id="L3348">                neighborsIdx[n1Idx] = n1Idx;</span>
<span class="pc bpc" id="L3349" title="4 of 8 branches missed.">                if ((x1 &lt; 0) || (y1 &lt; 0) || (x1 &gt; (w - 1)) || (y1 &gt; (h - 1))) {</span>
<span class="nc" id="L3350">                    neighborsCount[n1Idx] = 0;</span>
<span class="nc" id="L3351">                    continue;</span>
                }
<span class="fc" id="L3353">                int count = 0;</span>
                // count the neighbors of the neighbor
<span class="fc bfc" id="L3355" title="All 2 branches covered.">                for (int n2Idx = 0; n2Idx &lt; eightNeighborsX.length; ++n2Idx) {</span>
<span class="fc" id="L3356">                    int x2 = x1 + eightNeighborsX[n2Idx];</span>
<span class="fc" id="L3357">                    int y2 = y1 + eightNeighborsY[n2Idx];                </span>
<span class="pc bpc" id="L3358" title="2 of 8 branches missed.">                    if ((x2 &lt; 0) || (y2 &lt; 0) || (x2 &gt; (w - 1)) || (y2 &gt; (h - 1))) {</span>
<span class="nc" id="L3359">                        continue;</span>
                    }
<span class="fc" id="L3361">                    PairInt p4 = new PairInt(x2, y2);</span>
<span class="fc bfc" id="L3362" title="All 2 branches covered.">                    if (!tmpPointsRemoved.contains(p4) &amp;&amp; </span>
<span class="fc bfc" id="L3363" title="All 4 branches covered.">                        (tmpPointsAdded.contains(p4) || points.contains(p4))) {</span>
<span class="fc" id="L3364">                        count++;</span>
                    }
                }
<span class="fc" id="L3367">                neighborsCount[n1Idx] = count;</span>
            }
<span class="fc" id="L3369">            CountingSort.sort(neighborsCount, neighborsIdx, 8);</span>

<span class="fc bfc" id="L3371" title="All 2 branches covered.">            for (int ii = 0; ii &lt; neighborsIdx.length; ++ii) {</span>
                
<span class="pc bpc" id="L3373" title="1 of 2 branches missed.">                if (neighborsCount[ii] == 0) {</span>
<span class="nc" id="L3374">                    continue;</span>
                }
                
<span class="fc" id="L3377">                int nIdx = neighborsIdx[ii];</span>
                
<span class="fc" id="L3379">                int x2 = col + eightNeighborsX[nIdx];</span>
<span class="fc" id="L3380">                int y2 = centerRow + eightNeighborsY[nIdx];</span>
                
<span class="fc" id="L3382">                PairInt p4 = new PairInt(x2, y2);</span>

                // adds to tmpPointsRemoved
<span class="fc" id="L3385">                boolean nullable = erosionFilter.process(p4, points, </span>
                    tmpPointsAdded, tmpPointsRemoved, w, h);
               
            }
<span class="fc" id="L3389">        }</span>
        
<span class="fc" id="L3391">        int nCorrections = tmpPointsRemoved.size() + tmpPointsAdded.size();</span>

<span class="fc bfc" id="L3393" title="All 2 branches covered.">        for (PairInt p2 : tmpPointsRemoved) {</span>
<span class="fc" id="L3394">            points.remove(p2);</span>
<span class="fc" id="L3395">        }</span>
<span class="fc bfc" id="L3396" title="All 2 branches covered.">        for (PairInt p2 : tmpPointsAdded) {</span>
<span class="fc" id="L3397">            points.add(p2);</span>
<span class="fc" id="L3398">        }</span>
        
<span class="fc" id="L3400">        Logger.getLogger(PostLineThinnerCorrections.class.getName())</span>
<span class="fc" id="L3401">            .fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3402">            Integer.toString(nCorrections));</span>
        
<span class="fc" id="L3404">        return nCorrections;</span>
    }

    private void correctForCorrectionCreatedSquares(Set&lt;PairInt&gt; points, 
        int imageWidth, int imageHeight) {
        
<span class="fc" id="L3410">        int w = imageWidth;</span>
<span class="fc" id="L3411">        int h = imageHeight;</span>
        
        /*
        Find a filled in 2x2 square.
       
                   #  #      1
                   #* #      0
                               
         -3 -2 -1  0  1  2
        
         -- expand the region to the surrounding pixels and for each,
           null them if possible
        */
                
<span class="fc" id="L3425">        Set&lt;PairInt&gt; ones = new HashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3428">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L3429">        ones.add(new PairInt(1, 0));</span>
<span class="fc" id="L3430">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3432">        ErosionFilter erosionFilter = new ErosionFilter();</span>
<span class="fc" id="L3433">        erosionFilter.overrideEndOfLineCheck();</span>
                        
<span class="fc" id="L3435">        Set&lt;PairInt&gt; tmpPointsRemoved = new HashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3436">        Set&lt;PairInt&gt; tmpPointsAdded = new HashSet&lt;PairInt&gt;();</span>

<span class="fc bfc" id="L3438" title="All 2 branches covered.">        for (PairInt p : points) {</span>

<span class="fc" id="L3440">            int col = p.getX();</span>
<span class="fc" id="L3441">            int row = p.getY();</span>

            // make sure the current point hasn't been added to tmpPointsRemoved
<span class="fc" id="L3444">            boolean isNotPresent = tmpPointsRemoved.contains(p);</span>
<span class="fc bfc" id="L3445" title="All 2 branches covered.">            if (isNotPresent) {</span>
<span class="fc" id="L3446">                continue;</span>
            }

<span class="fc" id="L3449">            boolean foundPattern = true;</span>

<span class="fc bfc" id="L3451" title="All 2 branches covered.">            for (PairInt p2 : ones) {</span>
<span class="fc" id="L3452">                int x = col + p2.getX();</span>
<span class="fc" id="L3453">                int y = row + p2.getY();</span>
<span class="pc bpc" id="L3454" title="4 of 8 branches missed.">                if ((x &lt; 0) || (y &lt; 0) || (x &gt; (w - 1)) || (y &gt; (h - 1))) {</span>
<span class="nc" id="L3455">                    foundPattern = false;</span>
<span class="nc" id="L3456">                    break;</span>
                }
<span class="fc" id="L3458">                PairInt p3 = new PairInt(x, y);</span>
<span class="fc bfc" id="L3459" title="All 2 branches covered.">                if (tmpPointsRemoved.contains(p3) ||</span>
<span class="pc bpc" id="L3460" title="1 of 4 branches missed.">                    (!points.contains(p3) &amp;&amp; !tmpPointsAdded.contains(p3))) {</span>
<span class="fc" id="L3461">                    foundPattern = false;</span>
<span class="fc" id="L3462">                    break;</span>
                }
<span class="fc" id="L3464">            }</span>

<span class="fc bfc" id="L3466" title="All 2 branches covered.">            if (!foundPattern) {</span>
<span class="fc" id="L3467">                continue;</span>
            }
            
            /*
            visit each of the surrounding pixels and the center 4 in order
            of smallest number of neighbors, and null the ones which are 
            nullable without disconnecting lines.
            
                    +  +  +  +   2
                    +  #  #  +   1
                    +  #* #  +   0
                    +  +  +  +  -1
        
             -3 -2 -1  0  1  2
            */
            
<span class="fc" id="L3483">            int nn = 0;</span>
<span class="fc" id="L3484">            int[] neighborsCount = new int[16];</span>
<span class="fc" id="L3485">            PairInt[] neighbors = new PairInt[16];</span>
            
<span class="fc bfc" id="L3487" title="All 2 branches covered.">            for (int ii = -1; ii &lt;= 2; ++ii) {</span>
<span class="fc bfc" id="L3488" title="All 2 branches covered.">                for (int jj = -2; jj &lt;= 1; ++jj) {</span>
                    
<span class="fc" id="L3490">                    int x1 = col + ii;</span>
<span class="fc" id="L3491">                    int y1 = row + jj;</span>
                    
<span class="pc bpc" id="L3493" title="4 of 8 branches missed.">                    if ((x1 &lt; 0) || (y1 &lt; 0) || (x1 &gt; (w - 1)) || (y1 &gt; (h - 1))) {</span>
<span class="nc" id="L3494">                        continue;</span>
                    }
<span class="fc" id="L3496">                    PairInt p3 = new PairInt(x1, y1);</span>
<span class="fc bfc" id="L3497" title="All 2 branches covered.">                    if (tmpPointsRemoved.contains(p3) || </span>
<span class="pc bpc" id="L3498" title="1 of 4 branches missed.">                        (!tmpPointsAdded.contains(p3) &amp;&amp; !points.contains(p3))) {</span>
<span class="fc" id="L3499">                        continue;</span>
                    }

<span class="fc" id="L3502">                    neighbors[nn] = p3;</span>
                    
<span class="fc" id="L3504">                    int count = 0;</span>
                    // count the neighbors of the neighbor
<span class="fc bfc" id="L3506" title="All 2 branches covered.">                    for (int n2Idx = 0; n2Idx &lt; eightNeighborsX.length; ++n2Idx) {</span>
<span class="fc" id="L3507">                        int x2 = x1 + eightNeighborsX[n2Idx];</span>
<span class="fc" id="L3508">                        int y2 = y1 + eightNeighborsY[n2Idx];                </span>
<span class="pc bpc" id="L3509" title="4 of 8 branches missed.">                        if ((x2 &lt; 0) || (y2 &lt; 0) || (x2 &gt; (w - 1)) || (y2 &gt; (h - 1))) {</span>
<span class="nc" id="L3510">                            continue;</span>
                        }
<span class="fc" id="L3512">                        PairInt p4 = new PairInt(x2, y2);</span>
<span class="fc bfc" id="L3513" title="All 2 branches covered.">                        if (!tmpPointsRemoved.contains(p4) &amp;&amp; </span>
<span class="pc bpc" id="L3514" title="1 of 4 branches missed.">                            (tmpPointsAdded.contains(p4) || points.contains(p4))) {</span>
<span class="fc" id="L3515">                            count++;</span>
                        }
                    }
                    
<span class="fc" id="L3519">                    neighborsCount[nn] = count;</span>
<span class="fc" id="L3520">                    nn++;</span>
                }
            }
            
<span class="fc" id="L3524">            neighbors = Arrays.copyOf(neighbors, nn);</span>
<span class="fc" id="L3525">            neighborsCount = Arrays.copyOf(neighborsCount, nn);</span>
            
<span class="fc" id="L3527">            CountingSort.sort(neighborsCount, neighbors, 8);</span>

<span class="fc bfc" id="L3529" title="All 2 branches covered.">            for (int ii = 0; ii &lt; neighbors.length; ++ii) {</span>
<span class="pc bpc" id="L3530" title="1 of 2 branches missed.">                if (neighborsCount[ii] == 0) {</span>
<span class="nc" id="L3531">                    continue;</span>
                }
<span class="fc" id="L3533">                PairInt p3 = neighbors[ii]; </span>
                // adds to tmpPointsRemoved

<span class="fc" id="L3536">                boolean nullable = erosionFilter.process(p3, points, </span>
                    tmpPointsAdded, tmpPointsRemoved, w, h);
            }
<span class="fc" id="L3539">        }</span>

<span class="fc" id="L3541">        int nCorrections = tmpPointsRemoved.size() + tmpPointsAdded.size();</span>
        
<span class="fc bfc" id="L3543" title="All 2 branches covered.">        for (PairInt p2 : tmpPointsRemoved) {</span>
<span class="fc" id="L3544">            points.remove(p2);</span>
<span class="fc" id="L3545">        }</span>
<span class="pc bpc" id="L3546" title="1 of 2 branches missed.">        for (PairInt p2 : tmpPointsAdded) {</span>
<span class="nc" id="L3547">            points.add(p2);</span>
<span class="nc" id="L3548">        }</span>
        
<span class="fc" id="L3550">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3551">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3552">    }</span>

    protected void straightenLines(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
<span class="fc bfc" id="L3557" title="All 2 branches covered.">        if (edgeGuideImage == null) {</span>
<span class="fc" id="L3558">            return;</span>
        }
       
<span class="fc" id="L3561">        MiscellaneousCurveHelper curveHelper = new MiscellaneousCurveHelper();</span>
<span class="fc" id="L3562">        curveHelper.straightenLines(points, edgeGuideImage);</span>

<span class="fc" id="L3564">    }</span>
    
    private void correctForSingleHole_01(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*
          0  0  0  0  0         3                           3
          0  0  #  #  0         2           .  .            2
          0  #  0  #  #         1        .  0  .  #         1
          0  #  #  #* 0         0        .  #  #*           0
             #  0  0  0        -1        #                 -1
         -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3578">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3579">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3580">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3581">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3584">        zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3585">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3586">        zeroes.add(new PairInt(-2, -2)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3587">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3588">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3589">        zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L3591">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3592">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3593">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3594">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3596">        changeToZeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3597">        changeToZeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3598">        changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3599">        changeToZeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L3600">        changeToZeroes.add(new PairInt(0, -1));</span>
        
<span class="fc" id="L3602">        int nCorrections = 0;</span>
        
<span class="fc" id="L3604">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3607">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3610">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3611">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3612">    }</span>
    
    private void correctForSingleHole_02(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*    
          0  0  0  0  0         3                           3
          0  0  #  0  0         2           .               2
          0  #  0  #  0         1        .  0  .            1
          0  #  #  #* #         0        .  #  #* #         0
             #  0  0  0        -1        #                 -1
         -3 -2 -1  0  1  2           -3 -2 -1  0  1  2        
        */
        
<span class="fc" id="L3626">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3627">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3628">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3629">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3632">        zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1)); </span>
<span class="fc" id="L3633">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3634">        zeroes.add(new PairInt(-2, -2)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3635">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3636">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3637">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); </span>
<span class="fc" id="L3638">        zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L3640">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3641">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3642">        ones.add(new PairInt(0, -1));</span>
<span class="fc" id="L3643">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L3645">        changeToZeroes.add(new PairInt(-2, -1)); changeToZeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3646">        changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3647">        changeToZeroes.add(new PairInt(0, -1));</span>

<span class="fc" id="L3649">        int nCorrections = 0;</span>
        
<span class="fc" id="L3651">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3654">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3657">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3658">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3659">    }</span>
    
    private void correctForSingleHole_03(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*    
          0  0  0  0  0         3                           3
          0  0  #  #  0         2           .  .            2
          0  #  0  #  #         1        .  0  .  #         1
          0  #  #  #* 0         0        .  .  #*           0
          0  0  #  0  0        -1           #              -1
         -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3673">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3674">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3675">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3676">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3679">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3680">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3681">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, -2)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3682">        zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3683">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3684">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L3685">        zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L3687">        ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3688">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3689">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3690">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3692">        changeToZeroes.add(new PairInt(-2, 0)); changeToZeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3693">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3694">        changeToZeroes.add(new PairInt(0, -1)); changeToZeroes.add(new PairInt(0, -2));</span>
                    
<span class="fc" id="L3696">        int nCorrections = 0;</span>
        
<span class="fc" id="L3698">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3701">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3704">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3705">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3706">    }</span>
    
    private void correctForSingleHole_04(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*    
          0  0  0  0  0         3                           3
          0  0  #  #  0         2           .  .            2
          0  #  0  #  0         1        .  0  .            1
          0  #  #  #* #         0        .  .  #*           0
          0  0  #  0  0        -1           #              -1
         -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3720">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3721">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3722">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3723">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3726">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3727">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3728">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, -2)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3729">        zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3730">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3731">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, -1)); </span>
<span class="fc" id="L3732">        zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L3734">        ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3735">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3736">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3737">        ones.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L3739">        changeToZeroes.add(new PairInt(-2, 0)); changeToZeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3740">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3741">        changeToZeroes.add(new PairInt(0, -1)); changeToZeroes.add(new PairInt(0, -2));</span>
                    
<span class="fc" id="L3743">        int nCorrections = 0;</span>
        
<span class="fc" id="L3745">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3748">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3751">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3752">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3753">    }</span>
    
    private void correctForSingleHole_05(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*    
          0  0  0  0  0         3                           3
          0  0  #  #  0         2           .  .            2
          0  #  0  #  #         1        .  0  .  #         1
          #  #  #  #* 0         0        #  #  #*           0
          0  0  0  0  0        -1                          -1
         -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3767">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3768">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3769">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3770">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3773">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3774">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3775">        zeroes.add(new PairInt(-2, 1)); zeroes.add(new PairInt(-2, -2)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3776">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3777">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3778">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L3779">        zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L3781">        ones.add(new PairInt(-3, 0));</span>
<span class="fc" id="L3782">        ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3783">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3784">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3785">        ones.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3787">        changeToZeroes.add(new PairInt(-2, -1));</span>
<span class="fc" id="L3788">        changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3789">        changeToZeroes.add(new PairInt(0, -1)); changeToZeroes.add(new PairInt(0, -2));</span>
                    
<span class="fc" id="L3791">        int nCorrections = 0;</span>
        
<span class="fc" id="L3793">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3796">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3799">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3800">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3801">    }</span>
    
    private void correctForSingleHole_06(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*    
          0  0  0  0  #         3                 #         3
          0  #  #  #            2        .  .  #            2
          0  #  0  #  0         1        .  @  .            1
          0  #  #  #* 0         0        #  .  .*           0
          0  #  0  0  0        -1        #                 -1
         -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3815">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3816">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3817">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3818">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3821">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3822">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3823">        zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3824">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3825">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3826">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L3827">        zeroes.add(new PairInt(1, -1));</span>
        
<span class="fc" id="L3829">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); </span>
<span class="fc" id="L3830">        ones.add(new PairInt(-2, -1)); ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3831">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3832">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3833">        ones.add(new PairInt(1, -3));</span>
        
<span class="fc" id="L3835">        changeToZeroes.add(new PairInt(-2, -1)); changeToZeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3836">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L3837">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -1));</span>
                    
<span class="fc" id="L3839">        changeToOnes.add(new PairInt(-1, -1));</span>
        
<span class="fc" id="L3841">        int nCorrections = 0;</span>
        
<span class="fc" id="L3843">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3846">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3849">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3850">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3851">    }</span>
    
    private void correctForSingleHole_07(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*  
                 0  0  0  0  #      4                    #      4
              0  0  #  #  #         3           .  .  #         3
              0  #  #  0  #  0      2        .  .  @  .         2
              0  #  0  #  #  0      1        .  @  .  .         1
              0  #  #  #* 0  0      0        .  #  .*           0
              0  #  0  0  0        -1        #                 -1
             -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3866">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3867">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3868">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3869">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3872">        zeroes.add(new PairInt(-3, 1)); zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3873">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3874">        zeroes.add(new PairInt(-2, -3)); zeroes.add(new PairInt(-2, -4));</span>
<span class="fc" id="L3875">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -4));</span>
<span class="fc" id="L3876">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2)); zeroes.add(new PairInt(0, -4));</span>
<span class="fc" id="L3877">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L3878">        zeroes.add(new PairInt(1, -4));</span>
<span class="fc" id="L3879">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1)); zeroes.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L3881">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); </span>
<span class="fc" id="L3882">        ones.add(new PairInt(-2, -1)); ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3883">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2)); ones.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3884">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L3885">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2)); ones.add(new PairInt(1, -3));</span>
<span class="fc" id="L3886">        ones.add(new PairInt(2, -4));</span>
        
<span class="fc" id="L3888">        changeToZeroes.add(new PairInt(-2, 0)); changeToZeroes.add(new PairInt(-2, -1)); changeToZeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3889">        changeToZeroes.add(new PairInt(-1, -2)); changeToZeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3890">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -1)); changeToZeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3891">        changeToZeroes.add(new PairInt(1, -1)); changeToZeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L3893">        changeToOnes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3894">        changeToOnes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L3896">        int nCorrections = 0;</span>
        
<span class="fc" id="L3898">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3901">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3904">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3905">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3906">    }</span>
    
    private void correctForSingleHole_08(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*  
                 0  0  0  0  #      4                    #      4
              0  0  #  #  #         3           .  .  #         3
           0  0  #  #  0  #  0      2        .  .  @  .         2
           0  #  #  0  #  #  0      1     .  .  @  .  .         1
           0  #  0  #  #* 0  0      0     .  @  .  .*           0
           0  #  #  #  0  0        -1     #  .  .              -1
           0  #  0  0              -2     #                    -2
          -4 -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3922">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3923">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3924">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3925">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3928">        zeroes.add(new PairInt(-4, 2)); zeroes.add(new PairInt(-4, 1)); zeroes.add(new PairInt(-4, 0));</span>
<span class="fc" id="L3929">        zeroes.add(new PairInt(-4, -1)); zeroes.add(new PairInt(-4, -2));</span>
<span class="fc" id="L3930">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L3931">        zeroes.add(new PairInt(-2, 2)); zeroes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3932">        zeroes.add(new PairInt(-2, -3)); zeroes.add(new PairInt(-2, -4));</span>
<span class="fc" id="L3933">        zeroes.add(new PairInt(-1, 2)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -4));</span>
<span class="fc" id="L3934">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2)); zeroes.add(new PairInt(0, -4));</span>
<span class="fc" id="L3935">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -4));</span>
<span class="fc" id="L3936">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1)); zeroes.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L3938">        ones.add(new PairInt(-3, 2)); ones.add(new PairInt(-3, 1)); </span>
<span class="fc" id="L3939">        ones.add(new PairInt(-3, 0)); ones.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3940">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, -1)); ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3941">        ones.add(new PairInt(-1, 1)); ones.add(new PairInt(-1, 0)); </span>
<span class="fc" id="L3942">        ones.add(new PairInt(-1, -2)); ones.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3943">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L3944">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2)); ones.add(new PairInt(1, -3));</span>
<span class="fc" id="L3945">        ones.add(new PairInt(2, -4));</span>
        
<span class="fc" id="L3947">        changeToZeroes.add(new PairInt(-3, 0)); changeToZeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L3948">        changeToZeroes.add(new PairInt(-2, 1)); changeToZeroes.add(new PairInt(-2, -1)); changeToZeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L3949">        changeToZeroes.add(new PairInt(-1, 1)); changeToZeroes.add(new PairInt(-1, 0)); </span>
<span class="fc" id="L3950">        changeToZeroes.add(new PairInt(-1, -2)); changeToZeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L3951">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -1)); changeToZeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3952">        changeToZeroes.add(new PairInt(1, -1)); changeToZeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L3954">        changeToOnes.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3955">        changeToOnes.add(new PairInt(-1, -1));</span>
<span class="fc" id="L3956">        changeToOnes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L3958">        int nCorrections = 0;</span>
        
<span class="fc" id="L3960">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3963">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L3966">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L3967">            Integer.toString(nCorrections));</span>
<span class="fc" id="L3968">    }</span>
    
    private void correctForSingleHole_09(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*  
                                    4                           4
                 0  0  0  #  0      3                 #         3
                 0  #  #  #  0      2           .  #  #         2
                 0  #  0  #  0      1           #     #         1 
                 #  #  #* #  #      0        #  .  .* .  #      0
                    0  0  0        -1                          -1
                                   -2                          -2
          -4 -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3  
        */
        
<span class="fc" id="L3984">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3985">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3986">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L3987">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L3990">        zeroes.add(new PairInt(-2, -1)); zeroes.add(new PairInt(-2, -2)); zeroes.add(new PairInt(-2, -3));</span>
<span class="fc" id="L3991">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -4));</span>
<span class="fc" id="L3992">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L3993">        zeroes.add(new PairInt(1, 1));</span>
<span class="fc" id="L3994">        zeroes.add(new PairInt(2, -1)); zeroes.add(new PairInt(2, -2)); zeroes.add(new PairInt(2, -3));</span>
        
<span class="fc" id="L3996">        ones.add(new PairInt(-2, 0));</span>
<span class="fc" id="L3997">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1)); ones.add(new PairInt(-1, -2)); </span>
<span class="fc" id="L3998">        ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L3999">        ones.add(new PairInt(1, 0)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L4000">        ones.add(new PairInt(1, -2)); ones.add(new PairInt(1, -3));</span>
<span class="fc" id="L4001">        ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L4003">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2)); </span>
<span class="fc" id="L4004">        changeToZeroes.add(new PairInt(0, 0));</span>
<span class="fc" id="L4005">        changeToZeroes.add(new PairInt(1, 0));</span>
        
<span class="fc" id="L4007">        int nCorrections = 0;</span>
        
<span class="fc" id="L4009">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4012">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4015">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L4016">            Integer.toString(nCorrections));</span>
<span class="fc" id="L4017">    }</span>
    
    private void correctForSingleHole_10(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*
                     0 0        3                          3
                   0 # 0 0      2           # 0 .          2
                 # # 0 # 0 0    1           # # 0 .        1
                   # #*0 # 0    0             # #*0 .      0
                     # # #     -1               #         -1
        
        -6-5-4-3-2-1 0 1 2 3       -6-5-4-3-2-1 0 1 2 3
        */
        
<span class="fc" id="L4032">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4033">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4034">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4035">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L4038">        zeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L4039">        zeroes.add(new PairInt(0, -1)); zeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L4040">        zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -2)); zeroes.add(new PairInt(1, -3));</span>
<span class="fc" id="L4041">        zeroes.add(new PairInt(2, -1)); zeroes.add(new PairInt(2, -2));</span>
<span class="fc" id="L4042">        zeroes.add(new PairInt(3, 0)); zeroes.add(new PairInt(3, -1));</span>
        
<span class="fc" id="L4044">        ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L4045">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -1)); </span>
<span class="fc" id="L4046">        ones.add(new PairInt(0, 1)); ones.add(new PairInt(0, -2));</span>
<span class="fc" id="L4047">        ones.add(new PairInt(1, 1)); ones.add(new PairInt(1, -1));</span>
<span class="fc" id="L4048">        ones.add(new PairInt(2, 1)); ones.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L4050">        changeToZeroes.add(new PairInt(0, -2));</span>
<span class="fc" id="L4051">        changeToZeroes.add(new PairInt(1, -1));</span>
<span class="fc" id="L4052">        changeToZeroes.add(new PairInt(2, 0));</span>
        
<span class="fc" id="L4054">        int nCorrections = 0;</span>
        
<span class="fc" id="L4056">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4059">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4062">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L4063">            Integer.toString(nCorrections));</span>
<span class="fc" id="L4064">    }</span>
    
    private void correctForSingleHole_11(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*
                 0  0  0  #         4                 #         4
              0  0  #  #  #  0      3           .  .  #         3
              0  #  #  0  #  0      2        .  .  @  .         2
              0  #  0  #  #  0      1        .  @  .  .         1
              0  #  #  #* 0  0      0        #  .  .*           0
                 #  0  0  0        -1        #                 -1
             -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3
        */
        
<span class="fc" id="L4079">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4080">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4081">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4082">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
       
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L4085">        zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L4086">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L4087">        zeroes.add(new PairInt(-2, -3)); zeroes.add(new PairInt(-2, -4));</span>
<span class="fc" id="L4088">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -4));</span>
<span class="fc" id="L4089">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2)); zeroes.add(new PairInt(0, -4));</span>
<span class="fc" id="L4090">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); </span>
<span class="fc" id="L4091">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
<span class="fc" id="L4092">        zeroes.add(new PairInt(2, -2)); zeroes.add(new PairInt(2, -3));</span>
        
<span class="fc" id="L4094">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L4095">        ones.add(new PairInt(-2, -2)); </span>
<span class="fc" id="L4096">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2)); ones.add(new PairInt(-1, -3)); </span>
<span class="fc" id="L4097">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L4098">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2));</span>
<span class="fc" id="L4099">        ones.add(new PairInt(1, -3)); ones.add(new PairInt(1, -4));</span>
        
<span class="fc" id="L4101">        changeToZeroes.add(new PairInt(-2, -1)); changeToZeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L4102">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L4103">        changeToZeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L4104">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L4105">        changeToZeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L4106">        changeToZeroes.add(new PairInt(1, -1)); changeToZeroes.add(new PairInt(1, -2));</span>
        
<span class="fc" id="L4108">        changeToOnes.add(new PairInt(-1, -1)); changeToOnes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L4110">        int nCorrections = 0;</span>
        
<span class="fc" id="L4112">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4115">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4118">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L4119">            Integer.toString(nCorrections));</span>
<span class="fc" id="L4120">    }</span>
    
    private void correctForSingleHole_12(Set&lt;PairInt&gt; points, int imageWidth, 
        int imageHeight) {
        
        /*
                 0  0  0  0  #      4                   #       4
              0  0  #  #  #  #      3           .  .  # .       3
              0  #  #  0  #  0      2        .  .  @  .         2
              0  #  0  #  #  0      1        .  @  .  .         1
              0  #  #  #* 0  0      0        #  .  .*           0
                 #  0  0  0        -1        #                 -1
             -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3
        */
        
<span class="fc" id="L4135">        LinkedHashSet&lt;PairInt&gt; ones = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4136">        LinkedHashSet&lt;PairInt&gt; zeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4137">        LinkedHashSet&lt;PairInt&gt; changeToZeroes = new LinkedHashSet&lt;PairInt&gt;();</span>
<span class="fc" id="L4138">        LinkedHashSet&lt;PairInt&gt; changeToOnes = new LinkedHashSet&lt;PairInt&gt;();</span>
  
        // y's are inverted here because sketch above is top left is (0,0)
<span class="fc" id="L4141">        zeroes.add(new PairInt(-3, 0)); zeroes.add(new PairInt(-3, -1));</span>
<span class="fc" id="L4142">        zeroes.add(new PairInt(-3, -2)); zeroes.add(new PairInt(-3, -3));</span>
<span class="fc" id="L4143">        zeroes.add(new PairInt(-2, -3)); zeroes.add(new PairInt(-2, -4));</span>
<span class="fc" id="L4144">        zeroes.add(new PairInt(-1, 1)); zeroes.add(new PairInt(-1, -1)); zeroes.add(new PairInt(-1, -4));</span>
<span class="fc" id="L4145">        zeroes.add(new PairInt(0, 1)); zeroes.add(new PairInt(0, -2)); zeroes.add(new PairInt(0, -4));</span>
<span class="fc" id="L4146">        zeroes.add(new PairInt(1, 1)); zeroes.add(new PairInt(1, 0)); zeroes.add(new PairInt(1, -4)); </span>
<span class="fc" id="L4147">        zeroes.add(new PairInt(2, 0)); zeroes.add(new PairInt(2, -1));</span>
<span class="fc" id="L4148">        zeroes.add(new PairInt(2, -2));</span>
        
<span class="fc" id="L4150">        ones.add(new PairInt(-2, 1)); ones.add(new PairInt(-2, 0)); ones.add(new PairInt(-2, -1));</span>
<span class="fc" id="L4151">        ones.add(new PairInt(-2, -2));</span>
<span class="fc" id="L4152">        ones.add(new PairInt(-1, 0)); ones.add(new PairInt(-1, -2)); ones.add(new PairInt(-1, -3)); </span>
<span class="fc" id="L4153">        ones.add(new PairInt(0, -1)); ones.add(new PairInt(0, -3));</span>
<span class="fc" id="L4154">        ones.add(new PairInt(1, -1)); ones.add(new PairInt(1, -2)); </span>
<span class="fc" id="L4155">        ones.add(new PairInt(1, -3)); </span>
<span class="fc" id="L4156">        ones.add(new PairInt(2, -3)); ones.add(new PairInt(2, -4));</span>
        
        /*
                 0  0  0  0  #      4                    #      4
              0  0  #  #  #  #      3           .  .  #  .      3
              0  #  #  0  #  0      2        .  .  @  .         2
              0  #  0  #  #  0      1        .  @  .  .         1
              0  #  #  #* 0  0      0        #  .  .*           0
                 #  0  0  0        -1        #                 -1
             -3 -2 -1  0  1  2  3        -3 -2 -1  0  1  2  3
        */
<span class="fc" id="L4167">        changeToZeroes.add(new PairInt(-2, -1)); changeToZeroes.add(new PairInt(-2, -2));</span>
<span class="fc" id="L4168">        changeToZeroes.add(new PairInt(-1, 0)); changeToZeroes.add(new PairInt(-1, -2));</span>
<span class="fc" id="L4169">        changeToZeroes.add(new PairInt(-1, -3));</span>
<span class="fc" id="L4170">        changeToZeroes.add(new PairInt(0, 0)); changeToZeroes.add(new PairInt(0, -1));</span>
<span class="fc" id="L4171">        changeToZeroes.add(new PairInt(0, -3));</span>
<span class="fc" id="L4172">        changeToZeroes.add(new PairInt(1, -1)); changeToZeroes.add(new PairInt(1, -2));</span>
<span class="fc" id="L4173">        changeToZeroes.add(new PairInt(2, -3));</span>
        
<span class="fc" id="L4175">        changeToOnes.add(new PairInt(-1, -1)); changeToOnes.add(new PairInt(0, -2));</span>
        
<span class="fc" id="L4177">        int nCorrections = 0;</span>
        
<span class="fc" id="L4179">        nCorrections += replacePattern(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4182">        nCorrections += rotate90ThreeTimes(points, imageWidth, imageHeight,</span>
            zeroes, ones, changeToZeroes, changeToOnes);
        
<span class="fc" id="L4185">        log.fine(&quot;method &quot; + MiscDebug.getInvokingMethodName() + &quot; nc=&quot; + </span>
<span class="fc" id="L4186">            Integer.toString(nCorrections));</span>
<span class="fc" id="L4187">    }</span>
    
    /**
     * given an ordered list of corners, remove any corners that appear to be 
     * the artifact of a single pixel staircases in a straight line that is 
     * nearly vertical or nearly horizontal. Note that ordered list of corners
     * means that edgeCorners data are internally ordered by increasing values
     * of idx.
     * runtime complexity is O(N_corners).
     * @param edgeCorners 
     * @param curveIsClosed 
     */
    public static void removeSingleStairsAliasArtifacts(CornerArray edgeCorners, 
        boolean curveIsClosed) {
        
<span class="fc" id="L4202">        int nMaxIter = edgeCorners.getN();</span>
<span class="fc" id="L4203">        int nIter = 0;</span>
<span class="fc" id="L4204">        int nRemoved = 0;</span>
<span class="fc bfc" id="L4205" title="All 6 branches covered.">        while ((nIter == 0) || ((nIter &lt; nMaxIter) &amp;&amp; (nRemoved &gt; 0))) {</span>
            
<span class="fc" id="L4207">            nRemoved = removeSingleStairAliasArtifacts(edgeCorners, </span>
                curveIsClosed);
            
<span class="fc" id="L4210">            nIter++;</span>
        }
<span class="fc" id="L4212">    }</span>
    
    /**
     * given an ordered list of corners, remove any corners that appear to be 
     * the artifact of a single pixel staircase in a straight line that is 
     * nearly vertical or nearly horizontal. Note that ordered list of corners
     * means that edgeCorners data are internally ordered by increasing values
     * of idx.
     * runtime complexity is O(N_corners).
     * @param edgeCorners 
     * @param curveIsClosed 
     */
    protected static int removeSingleStairAliasArtifacts(CornerArray edgeCorners, 
        boolean curveIsClosed) {
        
<span class="fc bfc" id="L4227" title="All 2 branches covered.">        if (edgeCorners.getN() &lt; 3) {</span>
<span class="fc" id="L4228">            return 0;</span>
        }
        
        /*
        look for pattern __-- embedded between 2 corners that have the same 
        y's as the 1 pixel step
        then do same for vertical pattern.
        */
        
<span class="fc" id="L4237">        List&lt;Integer&gt; remove = new ArrayList&lt;Integer&gt;();</span>
        
<span class="fc bfc" id="L4239" title="All 2 branches covered.">        for (int i = 1; i &lt; edgeCorners.getN() - 1; ++i) {</span>
<span class="fc" id="L4240">            int xa = Math.round(edgeCorners.getX(i - 1));</span>
<span class="fc" id="L4241">            int ya = Math.round(edgeCorners.getY(i - 1));</span>
            
<span class="fc" id="L4243">            int xb = Math.round(edgeCorners.getX(i));</span>
<span class="fc" id="L4244">            int yb = Math.round(edgeCorners.getY(i));</span>
            
<span class="fc" id="L4246">            int xc = Math.round(edgeCorners.getX(i + 1));</span>
<span class="fc" id="L4247">            int yc = Math.round(edgeCorners.getY(i + 1));</span>
            
<span class="fc" id="L4249">            int diffYac = Math.abs(ya - yc);</span>
<span class="fc" id="L4250">            int diffYab = Math.abs(ya - yb);</span>
<span class="fc" id="L4251">            int diffYbc = Math.abs(yb - yc);</span>
                        
<span class="pc bpc" id="L4253" title="1 of 10 branches missed.">            if ((diffYac == 1) &amp;&amp; (</span>
                ((diffYab == 0) &amp;&amp; (diffYbc == 1)) ||
                ((diffYab == 1) &amp;&amp; (diffYbc == 0)))) {
                
<span class="fc bfc" id="L4257" title="All 8 branches covered.">                if (((xa &lt; xb) &amp;&amp; (xb &lt; xc)) || ((xa &gt; xb) &amp;&amp; (xb &gt; xc))) {</span>
<span class="fc" id="L4258">                    remove.add(Integer.valueOf(i));</span>
<span class="fc" id="L4259">                    ++i;</span>
<span class="fc" id="L4260">                    continue;</span>
                }
            }
        
<span class="fc" id="L4264">            int diffXac = Math.abs(xa - xc);</span>
<span class="fc" id="L4265">            int diffXab = Math.abs(xa - xb);</span>
<span class="fc" id="L4266">            int diffXbc = Math.abs(xb - xc);</span>
            
<span class="pc bpc" id="L4268" title="1 of 10 branches missed.">            if ((diffXac == 1) &amp;&amp; (</span>
                ((diffXab == 0) &amp;&amp; (diffXbc == 1)) ||
                ((diffXab == 1) &amp;&amp; (diffXbc == 0)))) {
                
<span class="fc bfc" id="L4272" title="All 8 branches covered.">                if (((ya &lt; yb) &amp;&amp; (yb &lt; yc)) || ((ya &gt; yb) &amp;&amp; (yb &gt; yc))) {</span>
<span class="fc" id="L4273">                    remove.add(Integer.valueOf(i));</span>
<span class="fc" id="L4274">                    ++i;</span>
                }
            }
        }
        
<span class="fc bfc" id="L4279" title="All 2 branches covered.">        if (curveIsClosed) {</span>
            
<span class="fc" id="L4281">            int n = edgeCorners.getN();</span>
            
<span class="pc bpc" id="L4283" title="1 of 2 branches missed.">            boolean contains = remove.contains(Integer.valueOf(n - 1)) || </span>
<span class="pc bpc" id="L4284" title="1 of 2 branches missed.">                remove.contains(Integer.valueOf(0)) ||</span>
<span class="fc bfc" id="L4285" title="All 2 branches covered.">                remove.contains(Integer.valueOf(1));</span>
            
<span class="fc bfc" id="L4287" title="All 2 branches covered.">            if (!contains) {</span>
                
<span class="fc" id="L4289">                int xa = Math.round(edgeCorners.getX(n - 1));</span>
<span class="fc" id="L4290">                int ya = Math.round(edgeCorners.getY(n - 1));</span>

<span class="fc" id="L4292">                int xb = Math.round(edgeCorners.getX(0));</span>
<span class="fc" id="L4293">                int yb = Math.round(edgeCorners.getY(0));</span>

<span class="fc" id="L4295">                int xc = Math.round(edgeCorners.getX(1));</span>
<span class="fc" id="L4296">                int yc = Math.round(edgeCorners.getY(1));</span>
                
<span class="fc" id="L4298">                int diffYac = Math.abs(ya - yc);</span>
<span class="fc" id="L4299">                int diffYab = Math.abs(ya - yb);</span>
<span class="fc" id="L4300">                int diffYbc = Math.abs(yb - yc);</span>

<span class="pc bpc" id="L4302" title="1 of 10 branches missed.">                if ((diffYac == 1) &amp;&amp; (((diffYab == 0) &amp;&amp; (diffYbc == 1))</span>
                    || ((diffYab == 1) &amp;&amp; (diffYbc == 0)))) {
                    
<span class="pc bpc" id="L4305" title="1 of 8 branches missed.">                    if (((xa &lt; xb) &amp;&amp; (xb &lt; xc)) || ((xa &gt; xb) &amp;&amp; (xb &gt; xc))) {</span>
<span class="fc" id="L4306">                        remove.add(Integer.valueOf(0));</span>
                    }
                    
                } else {

<span class="fc" id="L4311">                    int diffXac = Math.abs(xa - xc);</span>
<span class="fc" id="L4312">                    int diffXab = Math.abs(xa - xb);</span>
<span class="fc" id="L4313">                    int diffXbc = Math.abs(xb - xc);</span>

<span class="pc bpc" id="L4315" title="1 of 10 branches missed.">                    if ((diffXac == 1) &amp;&amp; (((diffXab == 0) &amp;&amp; (diffXbc == 1))</span>
                        || ((diffXab == 1) &amp;&amp; (diffXbc == 0)))) {
                        
<span class="pc bpc" id="L4318" title="1 of 8 branches missed.">                        if (((ya &lt; yb) &amp;&amp; (yb &lt; yc)) || ((ya &gt; yb) &amp;&amp; (yb &gt; yc))) {</span>
<span class="fc" id="L4319">                            remove.add(Integer.valueOf(0));</span>
                        }
                    }
                }
            }
        }
        
<span class="fc bfc" id="L4326" title="All 2 branches covered.">        for (int i = (remove.size() - 1); i &gt; -1; --i) {</span>
<span class="fc" id="L4327">            int idx = remove.get(i).intValue();</span>
<span class="fc" id="L4328">            edgeCorners.removeRange(idx, idx);</span>
        }
        
<span class="fc" id="L4331">        return remove.size();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>