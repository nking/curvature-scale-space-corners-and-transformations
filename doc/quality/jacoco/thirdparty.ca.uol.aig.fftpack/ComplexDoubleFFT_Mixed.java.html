<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ComplexDoubleFFT_Mixed.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jacoco Report</a> &gt; <a href="index.source.html" class="el_package">thirdparty.ca.uol.aig.fftpack</a> &gt; <span class="el_source">ComplexDoubleFFT_Mixed.java</span></div><h1>ComplexDoubleFFT_Mixed.java</h1><pre class="source lang-java linenums">package thirdparty.ca.uol.aig.fftpack;
/**
    jfftpack is a Java version of fftpack. jfftpack is based
on Paul N. Swarztraubre's Fortran code and Pekka Janhuen's
C code. It is developed as part of my official duties as
lead software engineer for SCUBA-2 FTS projects
(www.roe.ac.uk/ukatc/projects/scubatwo/)

The original fftpack was public domain, so jfftpack is
public domain too. As such, this package is also released
under GPL. This software is in no way certified or guaranteed.

Notes:
Please read the following documents for FFT formula if necessary
http://www.netlib.org/fftpack/doc

  * @author Baoshe Zhang
  * @author Astronomical Instrument Group of University of Lethbridge.
*/
<span class="fc" id="L20">class ComplexDoubleFFT_Mixed</span>
{
    
/*----------------------------------------------------------------------
   passf2: Complex FFT's forward/backward processing of factor 2;
   isign is +1 for backward and -1 for forward transforms
  ----------------------------------------------------------------------*/

     void passf2(int ido, int l1, final double cc[], double ch[], final double wtable[], int offset, int isign) 
                  /*isign==+1 for backward transform*/
     {
          int     i, k, ah, ac;
          double  ti2, tr2;
          int iw1;

<span class="fc" id="L35">          iw1 = offset;</span>
<span class="fc bfc" id="L36" title="All 2 branches covered.">          if(ido&lt;=2)</span>
          {
<span class="fc bfc" id="L38" title="All 2 branches covered.">	       for(k=0; k&lt;l1; k++)</span>
	       {
<span class="fc" id="L40">	           ah=k*ido;</span>
<span class="fc" id="L41">	           ac=2*k*ido;</span>
<span class="fc" id="L42">	           ch[ah]=cc[ac]+cc[ac+ido];</span>
<span class="fc" id="L43">	           ch[ah+ido*l1]=cc[ac]-cc[ac+ido];</span>
<span class="fc" id="L44">	           ch[ah+1]=cc[ac+1]+cc[ac+ido+1];</span>
<span class="fc" id="L45">	           ch[ah+ido*l1+1]=cc[ac+1]-cc[ac+ido+1];</span>
	       }
          }
          else
          {
<span class="fc bfc" id="L50" title="All 2 branches covered.">	       for(k=0; k&lt;l1; k++)</span>
	       {
<span class="fc bfc" id="L52" title="All 2 branches covered.">	           for(i=0; i&lt;ido-1; i+=2)</span>
	           {
<span class="fc" id="L54">		        ah=i+k*ido;</span>
<span class="fc" id="L55">		        ac=i+2*k*ido;</span>
<span class="fc" id="L56">		        ch[ah]=cc[ac]+cc[ac+ido];</span>
<span class="fc" id="L57">		        tr2=cc[ac]-cc[ac+ido];</span>
<span class="fc" id="L58">		        ch[ah+1]=cc[ac+1]+cc[ac+1+ido];</span>
<span class="fc" id="L59">		        ti2=cc[ac+1]-cc[ac+1+ido];</span>
<span class="fc" id="L60">		        ch[ah+l1*ido+1]=wtable[i+iw1]*ti2+isign*wtable[i+1+iw1]*tr2;</span>
<span class="fc" id="L61">		        ch[ah+l1*ido]=wtable[i+iw1]*tr2-isign*wtable[i+1+iw1]*ti2;</span>
	           }
	       }
         }
<span class="fc" id="L65">     }</span>

/*----------------------------------------------------------------------
   passf3: Complex FFT's forward/backward processing of factor 3;
   isign is +1 for backward and -1 for forward transforms
  ----------------------------------------------------------------------*/
     void passf3(int ido, int l1, final double cc[], double ch[], final double wtable[], int offset, int isign)
     {
<span class="fc" id="L73">          final double taur=-0.5;</span>
<span class="fc" id="L74">          final double taui=0.866025403784439;</span>
          int     i, k, ac, ah;
          double  ci2, ci3, di2, di3, cr2, cr3, dr2, dr3, ti2, tr2;
          int iw1, iw2;
 
<span class="fc" id="L79">          iw1 = offset;</span>
<span class="fc" id="L80">          iw2 = iw1 + ido;</span>

<span class="pc bpc" id="L82" title="1 of 2 branches missed.">          if(ido==2)</span>
          {
<span class="nc bnc" id="L84" title="All 2 branches missed.">	       for(k=1; k&lt;=l1; k++)</span>
	       {
<span class="nc" id="L86">	           ac=(3*k-2)*ido;</span>
<span class="nc" id="L87">	           tr2=cc[ac]+cc[ac+ido];</span>
<span class="nc" id="L88">	           cr2=cc[ac-ido]+taur*tr2;</span>
<span class="nc" id="L89">	           ah=(k-1)*ido;</span>
<span class="nc" id="L90">	           ch[ah]=cc[ac-ido]+tr2;</span>

<span class="nc" id="L92">	           ti2=cc[ac+1]+cc[ac+ido+1];</span>
<span class="nc" id="L93">	           ci2=cc[ac-ido+1]+taur*ti2;</span>
<span class="nc" id="L94">	           ch[ah+1]=cc[ac-ido+1]+ti2;</span>

<span class="nc" id="L96">	           cr3=isign*taui*(cc[ac]-cc[ac+ido]);</span>
<span class="nc" id="L97">	           ci3=isign*taui*(cc[ac+1]-cc[ac+ido+1]);</span>
<span class="nc" id="L98">	           ch[ah+l1*ido]=cr2-ci3;</span>
<span class="nc" id="L99">	           ch[ah+2*l1*ido]=cr2+ci3;</span>
<span class="nc" id="L100">	           ch[ah+l1*ido+1]=ci2+cr3;</span>
<span class="nc" id="L101">	           ch[ah+2*l1*ido+1]=ci2-cr3;</span>
	       }
          }
          else
          {
<span class="fc bfc" id="L106" title="All 2 branches covered.">	       for(k=1; k&lt;=l1; k++)</span>
	       {
<span class="fc bfc" id="L108" title="All 2 branches covered.">	            for(i=0; i&lt;ido-1; i+=2)</span>
	            {
<span class="fc" id="L110">		         ac=i+(3*k-2)*ido;</span>
<span class="fc" id="L111">		         tr2=cc[ac]+cc[ac+ido];</span>
<span class="fc" id="L112">		         cr2=cc[ac-ido]+taur*tr2;</span>
<span class="fc" id="L113">		         ah=i+(k-1)*ido;</span>
<span class="fc" id="L114">		         ch[ah]=cc[ac-ido]+tr2;</span>
<span class="fc" id="L115">		         ti2=cc[ac+1]+cc[ac+ido+1];</span>
<span class="fc" id="L116">		         ci2=cc[ac-ido+1]+taur*ti2;</span>
<span class="fc" id="L117">		         ch[ah+1]=cc[ac-ido+1]+ti2;</span>
<span class="fc" id="L118">		         cr3=isign*taui*(cc[ac]-cc[ac+ido]);</span>
<span class="fc" id="L119">		         ci3=isign*taui*(cc[ac+1]-cc[ac+ido+1]);</span>
<span class="fc" id="L120">		         dr2=cr2-ci3;</span>
<span class="fc" id="L121">		         dr3=cr2+ci3;</span>
<span class="fc" id="L122">		         di2=ci2+cr3;</span>
<span class="fc" id="L123">		         di3=ci2-cr3;</span>
<span class="fc" id="L124">		         ch[ah+l1*ido+1]=wtable[i+iw1]*di2+isign*wtable[i+1+iw1]*dr2;</span>
<span class="fc" id="L125">		         ch[ah+l1*ido]=wtable[i+iw1]*dr2-isign*wtable[i+1+iw1]*di2;</span>
<span class="fc" id="L126">		         ch[ah+2*l1*ido+1]=wtable[i+iw2]*di3+isign*wtable[i+1+iw2]*dr3;</span>
<span class="fc" id="L127">		         ch[ah+2*l1*ido]=wtable[i+iw2]*dr3-isign*wtable[i+1+iw2]*di3;</span>
	            }
	       }
          }
<span class="fc" id="L131">     }</span>

/*----------------------------------------------------------------------
   passf4: Complex FFT's forward/backward processing of factor 4;
   isign is +1 for backward and -1 for forward transforms
  ----------------------------------------------------------------------*/
     void passf4(int ido, int l1, final double cc[], double ch[], final double wtable[], int offset, int isign)
     {
           int i, k, ac, ah;
           double  ci2, ci3, ci4, cr2, cr3, cr4, ti1, ti2, ti3, ti4, tr1, tr2, tr3, tr4;
           int iw1, iw2, iw3;
<span class="fc" id="L142">           iw1 = offset;</span>
<span class="fc" id="L143">           iw2 = iw1 + ido;</span>
<span class="fc" id="L144">           iw3 = iw2 + ido;</span>

<span class="fc bfc" id="L146" title="All 2 branches covered.">           if(ido==2)</span>
           {
<span class="fc bfc" id="L148" title="All 2 branches covered.">	        for(k=0; k&lt;l1; k++)</span>
	        {
<span class="fc" id="L150">	             ac=4*k*ido+1;</span>
<span class="fc" id="L151">	             ti1=cc[ac]-cc[ac+2*ido];</span>
<span class="fc" id="L152">	             ti2=cc[ac]+cc[ac+2*ido];</span>
<span class="fc" id="L153">	    	     tr4=cc[ac+3*ido]-cc[ac+ido];</span>
<span class="fc" id="L154">	    	     ti3=cc[ac+ido]+cc[ac+3*ido];</span>
<span class="fc" id="L155">	    	     tr1=cc[ac-1]-cc[ac+2*ido-1];</span>
<span class="fc" id="L156">	             tr2=cc[ac-1]+cc[ac+2*ido-1];</span>
<span class="fc" id="L157">	    	     ti4=cc[ac+ido-1]-cc[ac+3*ido-1];</span>
<span class="fc" id="L158">	             tr3=cc[ac+ido-1]+cc[ac+3*ido-1];</span>
<span class="fc" id="L159">	    	     ah=k*ido;</span>
<span class="fc" id="L160">	    	     ch[ah]=tr2+tr3;</span>
<span class="fc" id="L161">	     	     ch[ah+2*l1*ido]=tr2-tr3;</span>
<span class="fc" id="L162">	    	     ch[ah+1]=ti2+ti3;</span>
<span class="fc" id="L163">	    	     ch[ah+2*l1*ido+1]=ti2-ti3;</span>
<span class="fc" id="L164">	    	     ch[ah+l1*ido]=tr1+isign*tr4;</span>
<span class="fc" id="L165">	    	     ch[ah+3*l1*ido]=tr1-isign*tr4;</span>
<span class="fc" id="L166">	    	     ch[ah+l1*ido+1]=ti1+isign*ti4;</span>
<span class="fc" id="L167">	    	     ch[ah+3*l1*ido+1]=ti1-isign*ti4;</span>
	        }
           }
           else
           {
<span class="fc bfc" id="L172" title="All 2 branches covered.">	        for(k=0; k&lt;l1; k++)</span>
		{
<span class="fc bfc" id="L174" title="All 2 branches covered.">	    	     for(i=0; i&lt;ido-1; i+=2)</span>
	    	     {
<span class="fc" id="L176">			ac=i+1+4*k*ido;</span>
<span class="fc" id="L177">			ti1=cc[ac]-cc[ac+2*ido];</span>
<span class="fc" id="L178">			ti2=cc[ac]+cc[ac+2*ido];</span>
<span class="fc" id="L179">			ti3=cc[ac+ido]+cc[ac+3*ido];</span>
<span class="fc" id="L180">			tr4=cc[ac+3*ido]-cc[ac+ido];</span>
<span class="fc" id="L181">			tr1=cc[ac-1]-cc[ac+2*ido-1];</span>
<span class="fc" id="L182">			tr2=cc[ac-1]+cc[ac+2*ido-1];</span>
<span class="fc" id="L183">			ti4=cc[ac+ido-1]-cc[ac+3*ido-1];</span>
<span class="fc" id="L184">			tr3=cc[ac+ido-1]+cc[ac+3*ido-1];</span>
<span class="fc" id="L185">			ah=i+k*ido;</span>
<span class="fc" id="L186">			ch[ah]=tr2+tr3;</span>
<span class="fc" id="L187">			cr3=tr2-tr3;</span>
<span class="fc" id="L188">			ch[ah+1]=ti2+ti3;</span>
<span class="fc" id="L189">			ci3=ti2-ti3;</span>
<span class="fc" id="L190">			cr2=tr1+isign*tr4;</span>
<span class="fc" id="L191">			cr4=tr1-isign*tr4;</span>
<span class="fc" id="L192">			ci2=ti1+isign*ti4;</span>
<span class="fc" id="L193">			ci4=ti1-isign*ti4;</span>
<span class="fc" id="L194">			ch[ah+l1*ido]=wtable[i+iw1]*cr2-isign*wtable[i+1+iw1]*ci2;</span>
<span class="fc" id="L195">			ch[ah+l1*ido+1]=wtable[i+iw1]*ci2+isign*wtable[i+1+iw1]*cr2;</span>
<span class="fc" id="L196">			ch[ah+2*l1*ido]=wtable[i+iw2]*cr3-isign*wtable[i+1+iw2]*ci3;</span>
<span class="fc" id="L197">			ch[ah+2*l1*ido+1]=wtable[i+iw2]*ci3+isign*wtable[i+1+iw2]*cr3;</span>
<span class="fc" id="L198">			ch[ah+3*l1*ido]=wtable[i+iw3]*cr4-isign*wtable[i+1+iw3]*ci4;</span>
<span class="fc" id="L199">			ch[ah+3*l1*ido+1]=wtable[i+iw3]*ci4+isign*wtable[i+1+iw3]*cr4;</span>
	    	     }
		}
    	   }
<span class="fc" id="L203">     } </span>

/*----------------------------------------------------------------------
   passf5: Complex FFT's forward/backward processing of factor 5;
   isign is +1 for backward and -1 for forward transforms
  ----------------------------------------------------------------------*/
     void passf5(int ido, int l1, final double cc[], double ch[], final double wtable[], int offset, int isign)
               /*isign==-1 for forward transform and+1 for backward transform*/
     {
<span class="fc" id="L212">    	final double tr11=0.309016994374947;</span>
<span class="fc" id="L213">    	final double ti11=0.951056516295154;</span>
<span class="fc" id="L214">    	final double tr12=-0.809016994374947;</span>
<span class="fc" id="L215">    	final double ti12=0.587785252292473;</span>
    	int     i, k, ac, ah;
    	double  ci2, ci3, ci4, ci5, di3, di4, di5, di2, cr2, cr3, cr5, cr4,
        	    ti2, ti3, ti4, ti5, dr3, dr4, dr5, dr2, tr2, tr3, tr4, tr5;
        int iw1, iw2, iw3, iw4;

<span class="fc" id="L221">        iw1 = offset;</span>
<span class="fc" id="L222">        iw2 = iw1 + ido;</span>
<span class="fc" id="L223">        iw3 = iw2 + ido;</span>
<span class="fc" id="L224">        iw4 = iw3 + ido;</span>

<span class="fc bfc" id="L226" title="All 2 branches covered.">	if(ido==2)</span>
    	{
<span class="fc bfc" id="L228" title="All 2 branches covered.">	    for(k=1; k&lt;=l1;++k)</span>
	    {
<span class="fc" id="L230">	    	ac=(5*k-4)*ido+1;</span>
<span class="fc" id="L231">	    	ti5=cc[ac]-cc[ac+3*ido];</span>
<span class="fc" id="L232">	    	ti2=cc[ac]+cc[ac+3*ido];</span>
<span class="fc" id="L233">	    	ti4=cc[ac+ido]-cc[ac+2*ido];</span>
<span class="fc" id="L234">	    	ti3=cc[ac+ido]+cc[ac+2*ido];</span>
<span class="fc" id="L235">	    	tr5=cc[ac-1]-cc[ac+3*ido-1];</span>
<span class="fc" id="L236">	    	tr2=cc[ac-1]+cc[ac+3*ido-1];</span>
<span class="fc" id="L237">	    	tr4=cc[ac+ido-1]-cc[ac+2*ido-1];</span>
<span class="fc" id="L238">	    	tr3=cc[ac+ido-1]+cc[ac+2*ido-1];</span>
<span class="fc" id="L239">	    	ah=(k-1)*ido;</span>
<span class="fc" id="L240">	    	ch[ah]=cc[ac-ido-1]+tr2+tr3;</span>
<span class="fc" id="L241">	    	ch[ah+1]=cc[ac-ido]+ti2+ti3;</span>
<span class="fc" id="L242">	    	cr2=cc[ac-ido-1]+tr11*tr2+tr12*tr3;</span>
<span class="fc" id="L243">	    	ci2=cc[ac-ido]+tr11*ti2+tr12*ti3;</span>
<span class="fc" id="L244">	    	cr3=cc[ac-ido-1]+tr12*tr2+tr11*tr3;</span>
<span class="fc" id="L245">	    	ci3=cc[ac-ido]+tr12*ti2+tr11*ti3;</span>
<span class="fc" id="L246">	    	cr5=isign*(ti11*tr5+ti12*tr4);</span>
<span class="fc" id="L247">	    	ci5=isign*(ti11*ti5+ti12*ti4);</span>
<span class="fc" id="L248">	    	cr4=isign*(ti12*tr5-ti11*tr4);</span>
<span class="fc" id="L249">	    	ci4=isign*(ti12*ti5-ti11*ti4);</span>
<span class="fc" id="L250">	    	ch[ah+l1*ido]=cr2-ci5;</span>
<span class="fc" id="L251">	    	ch[ah+4*l1*ido]=cr2+ci5;</span>
<span class="fc" id="L252">	    	ch[ah+l1*ido+1]=ci2+cr5;</span>
<span class="fc" id="L253">	    	ch[ah+2*l1*ido+1]=ci3+cr4;</span>
<span class="fc" id="L254">	    	ch[ah+2*l1*ido]=cr3-ci4;</span>
<span class="fc" id="L255">	    	ch[ah+3*l1*ido]=cr3+ci4;</span>
<span class="fc" id="L256">	    	ch[ah+3*l1*ido+1]=ci3-cr4;</span>
<span class="fc" id="L257">	    	ch[ah+4*l1*ido+1]=ci2-cr5;</span>
	    }
    	}
    	else
    	{
<span class="fc bfc" id="L262" title="All 2 branches covered.">	    for(k=1; k&lt;=l1; k++)</span>
	    {
<span class="fc bfc" id="L264" title="All 2 branches covered.">	    	for(i=0; i&lt;ido-1; i+=2)</span>
	    	{
<span class="fc" id="L266">			ac=i+1+(k*5-4)*ido;</span>
<span class="fc" id="L267">			ti5=cc[ac]-cc[ac+3*ido];</span>
<span class="fc" id="L268">			ti2=cc[ac]+cc[ac+3*ido];</span>
<span class="fc" id="L269">			ti4=cc[ac+ido]-cc[ac+2*ido];</span>
<span class="fc" id="L270">			ti3=cc[ac+ido]+cc[ac+2*ido];</span>
<span class="fc" id="L271">			tr5=cc[ac-1]-cc[ac+3*ido-1];</span>
<span class="fc" id="L272">			tr2=cc[ac-1]+cc[ac+3*ido-1];</span>
<span class="fc" id="L273">			tr4=cc[ac+ido-1]-cc[ac+2*ido-1];</span>
<span class="fc" id="L274">			tr3=cc[ac+ido-1]+cc[ac+2*ido-1];</span>
<span class="fc" id="L275">			ah=i+(k-1)*ido;</span>
<span class="fc" id="L276">			ch[ah]=cc[ac-ido-1]+tr2+tr3;</span>
<span class="fc" id="L277">			ch[ah+1]=cc[ac-ido]+ti2+ti3;</span>
<span class="fc" id="L278">			cr2=cc[ac-ido-1]+tr11*tr2+tr12*tr3;</span>

<span class="fc" id="L280">			ci2=cc[ac-ido]+tr11*ti2+tr12*ti3;</span>
<span class="fc" id="L281">			cr3=cc[ac-ido-1]+tr12*tr2+tr11*tr3;</span>

<span class="fc" id="L283">			ci3=cc[ac-ido]+tr12*ti2+tr11*ti3;</span>
<span class="fc" id="L284">			cr5=isign*(ti11*tr5+ti12*tr4);</span>
<span class="fc" id="L285">			ci5=isign*(ti11*ti5+ti12*ti4);</span>
<span class="fc" id="L286">			cr4=isign*(ti12*tr5-ti11*tr4);</span>
<span class="fc" id="L287">			ci4=isign*(ti12*ti5-ti11*ti4);</span>
<span class="fc" id="L288">			dr3=cr3-ci4;</span>
<span class="fc" id="L289">			dr4=cr3+ci4;</span>
<span class="fc" id="L290">			di3=ci3+cr4;</span>
<span class="fc" id="L291">			di4=ci3-cr4;</span>
<span class="fc" id="L292">			dr5=cr2+ci5;</span>
<span class="fc" id="L293">			dr2=cr2-ci5;</span>
<span class="fc" id="L294">			di5=ci2-cr5;</span>
<span class="fc" id="L295">			di2=ci2+cr5;</span>
<span class="fc" id="L296">			ch[ah+l1*ido]=wtable[i+iw1]*dr2-isign*wtable[i+1+iw1]*di2;</span>
<span class="fc" id="L297">			ch[ah+l1*ido+1]=wtable[i+iw1]*di2+isign*wtable[i+1+iw1]*dr2;</span>
<span class="fc" id="L298">			ch[ah+2*l1*ido]=wtable[i+iw2]*dr3-isign*wtable[i+1+iw2]*di3;</span>
<span class="fc" id="L299">			ch[ah+2*l1*ido+1]=wtable[i+iw2]*di3+isign*wtable[i+1+iw2]*dr3;</span>
<span class="fc" id="L300">			ch[ah+3*l1*ido]=wtable[i+iw3]*dr4-isign*wtable[i+1+iw3]*di4;</span>
<span class="fc" id="L301">			ch[ah+3*l1*ido+1]=wtable[i+iw3]*di4+isign*wtable[i+1+iw3]*dr4;</span>
<span class="fc" id="L302">			ch[ah+4*l1*ido]=wtable[i+iw4]*dr5-isign*wtable[i+1+iw4]*di5;</span>
<span class="fc" id="L303">			ch[ah+4*l1*ido+1]=wtable[i+iw4]*di5+isign*wtable[i+1+iw4]*dr5;</span>
	    	}
	    }
         }
<span class="fc" id="L307">     }</span>

/*----------------------------------------------------------------------
   passfg: Complex FFT's forward/backward processing of general factor;
   isign is +1 for backward and -1 for forward transforms
  ----------------------------------------------------------------------*/
    void passfg(int nac[], int ido, int ip, int l1, int idl1,
        final double cc[], double c1[], double c2[], double ch[], double ch2[],
        final double wtable[], int offset, int isign) {
        int idij, idlj, idot, ipph, i, j, k, l, jc, lc, ik, nt, idj, idl, inc, idp;
        double wai, war;
        int iw1;

<span class="fc" id="L320">        iw1 = offset;</span>
<span class="fc" id="L321">        idot = ido / 2;</span>
<span class="fc" id="L322">        nt = ip * idl1;</span>
<span class="fc" id="L323">        ipph = (ip + 1) / 2;</span>
<span class="fc" id="L324">        idp = ip * ido;</span>
<span class="fc bfc" id="L325" title="All 2 branches covered.">        if (ido &gt;= l1) {</span>
<span class="fc bfc" id="L326" title="All 2 branches covered.">            for (j = 1; j &lt; ipph; j++) {</span>
<span class="fc" id="L327">                jc = ip - j;</span>
<span class="fc bfc" id="L328" title="All 2 branches covered.">                for (k = 0; k &lt; l1; k++) {</span>
<span class="fc bfc" id="L329" title="All 2 branches covered.">                    for (i = 0; i &lt; ido; i++) {</span>
<span class="fc" id="L330">                        ch[i + (k + j * l1) * ido] = cc[i + (j + k * ip) * ido] + cc[i + (jc + k * ip) * ido];</span>
<span class="fc" id="L331">                        ch[i + (k + jc * l1) * ido] = cc[i + (j + k * ip) * ido] - cc[i + (jc + k * ip) * ido];</span>
                    }
                }
            }
<span class="fc bfc" id="L335" title="All 2 branches covered.">            for (k = 0; k &lt; l1; k++) {</span>
<span class="fc bfc" id="L336" title="All 2 branches covered.">                for (i = 0; i &lt; ido; i++) {</span>
<span class="fc" id="L337">                    ch[i + k * ido] = cc[i + k * ip * ido];</span>
                }
            }
        } else {
<span class="fc bfc" id="L341" title="All 2 branches covered.">            for (j = 1; j &lt; ipph; j++) {</span>
<span class="fc" id="L342">                jc = ip - j;</span>
<span class="fc bfc" id="L343" title="All 2 branches covered.">                for (i = 0; i &lt; ido; i++) {</span>
<span class="fc bfc" id="L344" title="All 2 branches covered.">                    for (k = 0; k &lt; l1; k++) {</span>
<span class="fc" id="L345">                        ch[i + (k + j * l1) * ido] = cc[i + (j + k * ip) * ido] + cc[i + (jc + k * ip) * ido];</span>
<span class="fc" id="L346">                        ch[i + (k + jc * l1) * ido] = cc[i + (j + k * ip) * ido] - cc[i + (jc + k * ip) * ido];</span>
                    }
                }
            }
<span class="fc bfc" id="L350" title="All 2 branches covered.">            for (i = 0; i &lt; ido; i++) {</span>
<span class="fc bfc" id="L351" title="All 2 branches covered.">                for (k = 0; k &lt; l1; k++) {</span>
<span class="fc" id="L352">                    ch[i + k * ido] = cc[i + k * ip * ido];</span>
                }
            }
        }

<span class="fc" id="L357">        idl = 2 - ido;</span>
<span class="fc" id="L358">        inc = 0;</span>
<span class="fc bfc" id="L359" title="All 2 branches covered.">        for (l = 1; l &lt; ipph; l++) {</span>
<span class="fc" id="L360">            lc = ip - l;</span>
<span class="fc" id="L361">            idl += ido;</span>
<span class="fc bfc" id="L362" title="All 2 branches covered.">            for (ik = 0; ik &lt; idl1; ik++) {</span>
<span class="fc" id="L363">                c2[ik + l * idl1] = ch2[ik] + wtable[idl - 2 + iw1] * ch2[ik + idl1];</span>
<span class="fc" id="L364">                c2[ik + lc * idl1] = isign * wtable[idl - 1 + iw1] * ch2[ik + (ip - 1) * idl1];</span>
            }
<span class="fc" id="L366">            idlj = idl;</span>
<span class="fc" id="L367">            inc += ido;</span>
<span class="fc bfc" id="L368" title="All 2 branches covered.">            for (j = 2; j &lt; ipph; j++) {</span>
<span class="fc" id="L369">                jc = ip - j;</span>
<span class="fc" id="L370">                idlj += inc;</span>
<span class="fc bfc" id="L371" title="All 2 branches covered.">                if (idlj &gt; idp) {</span>
<span class="fc" id="L372">                    idlj -= idp;</span>
                }
<span class="fc" id="L374">                war = wtable[idlj - 2 + iw1];</span>
<span class="fc" id="L375">                wai = wtable[idlj - 1 + iw1];</span>
<span class="fc bfc" id="L376" title="All 2 branches covered.">                for (ik = 0; ik &lt; idl1; ik++) {</span>
<span class="fc" id="L377">                    c2[ik + l * idl1] += war * ch2[ik + j * idl1];</span>
<span class="fc" id="L378">                    c2[ik + lc * idl1] += isign * wai * ch2[ik + jc * idl1];</span>
                }
            }
        }
<span class="fc bfc" id="L382" title="All 2 branches covered.">        for (j = 1; j &lt; ipph; j++) {</span>
<span class="fc bfc" id="L383" title="All 2 branches covered.">            for (ik = 0; ik &lt; idl1; ik++) {</span>
<span class="fc" id="L384">                ch2[ik] += ch2[ik + j * idl1];</span>
            }
        }
<span class="fc bfc" id="L387" title="All 2 branches covered.">        for (j = 1; j &lt; ipph; j++) {</span>
<span class="fc" id="L388">            jc = ip - j;</span>
<span class="fc bfc" id="L389" title="All 2 branches covered.">            for (ik = 1; ik &lt; idl1; ik += 2) {</span>
<span class="fc" id="L390">                ch2[ik - 1 + j * idl1] = c2[ik - 1 + j * idl1] - c2[ik + jc * idl1];</span>
<span class="fc" id="L391">                ch2[ik - 1 + jc * idl1] = c2[ik - 1 + j * idl1] + c2[ik + jc * idl1];</span>
<span class="fc" id="L392">                ch2[ik + j * idl1] = c2[ik + j * idl1] + c2[ik - 1 + jc * idl1];</span>
<span class="fc" id="L393">                ch2[ik + jc * idl1] = c2[ik + j * idl1] - c2[ik - 1 + jc * idl1];</span>
            }
        }
<span class="fc" id="L396">        nac[0] = 1;</span>
<span class="fc bfc" id="L397" title="All 2 branches covered.">        if (ido == 2) {</span>
<span class="fc" id="L398">            return;</span>
        }
<span class="fc" id="L400">        nac[0] = 0;</span>
<span class="fc bfc" id="L401" title="All 2 branches covered.">        for (ik = 0; ik &lt; idl1; ik++) {</span>
<span class="fc" id="L402">            c2[ik] = ch2[ik];</span>
        }
<span class="fc bfc" id="L404" title="All 2 branches covered.">        for (j = 1; j &lt; ip; j++) {</span>
<span class="fc bfc" id="L405" title="All 2 branches covered.">            for (k = 0; k &lt; l1; k++) {</span>
<span class="fc" id="L406">                c1[(k + j * l1) * ido + 0] = ch[(k + j * l1) * ido + 0];</span>
<span class="fc" id="L407">                c1[(k + j * l1) * ido + 1] = ch[(k + j * l1) * ido + 1];</span>
            }
        }
<span class="pc bpc" id="L410" title="1 of 2 branches missed.">        if (idot &lt;= l1) {</span>
<span class="nc" id="L411">            idij = 0;</span>
<span class="nc bnc" id="L412" title="All 2 branches missed.">            for (j = 1; j &lt; ip; j++) {</span>
<span class="nc" id="L413">                idij += 2;</span>
<span class="nc bnc" id="L414" title="All 2 branches missed.">                for (i = 3; i &lt; ido; i += 2) {</span>
<span class="nc" id="L415">                    idij += 2;</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">                    for (k = 0; k &lt; l1; k++) {</span>
<span class="nc" id="L417">                        c1[i - 1 + (k + j * l1) * ido]</span>
                            = wtable[idij - 2 + iw1] * ch[i - 1 + (k + j * l1) * ido]
                            - isign * wtable[idij - 1 + iw1] * ch[i + (k + j * l1) * ido];
<span class="nc" id="L420">                        c1[i + (k + j * l1) * ido]</span>
                            = wtable[idij - 2 + iw1] * ch[i + (k + j * l1) * ido]
                            + isign * wtable[idij - 1 + iw1] * ch[i - 1 + (k + j * l1) * ido];
                    }
                }
            }
        } else {
<span class="fc" id="L427">            idj = 2 - ido;</span>
<span class="fc bfc" id="L428" title="All 2 branches covered.">            for (j = 1; j &lt; ip; j++) {</span>
<span class="fc" id="L429">                idj += ido;</span>
<span class="fc bfc" id="L430" title="All 2 branches covered.">                for (k = 0; k &lt; l1; k++) {</span>
<span class="fc" id="L431">                    idij = idj;</span>
<span class="fc bfc" id="L432" title="All 2 branches covered.">                    for (i = 3; i &lt; ido; i += 2) {</span>
<span class="fc" id="L433">                        idij += 2;</span>
<span class="fc" id="L434">                        c1[i - 1 + (k + j * l1) * ido]</span>
                            = wtable[idij - 2 + iw1] * ch[i - 1 + (k + j * l1) * ido]
                            - isign * wtable[idij - 1 + iw1] * ch[i + (k + j * l1) * ido];
<span class="fc" id="L437">                        c1[i + (k + j * l1) * ido]</span>
                            = wtable[idij - 2 + iw1] * ch[i + (k + j * l1) * ido]
                            + isign * wtable[idij - 1 + iw1] * ch[i - 1 + (k + j * l1) * ido];
                    }
                }
            }
        }
<span class="fc" id="L444">    }</span>
    

/*---------------------------------------------------------
   cfftf1: further processing of Complex forward FFT
  --------------------------------------------------------*/
    void cfftf1(int n, double c[], final double wtable[], int isign) {
        int idot, i;
        int k1, l1, l2;
        int na, nf, ip, iw, ido, idl1;
<span class="fc" id="L454">        int[] nac = new int[1];</span>

        int iw1, iw2;
<span class="fc" id="L457">        double[] ch = new double[2 * n];</span>

<span class="fc" id="L459">        iw1 = 2 * n;</span>
<span class="fc" id="L460">        iw2 = 4 * n;</span>
<span class="fc" id="L461">        System.arraycopy(wtable, 0, ch, 0, 2 * n);</span>

<span class="fc" id="L463">        nac[0] = 0;</span>

<span class="fc" id="L465">        nf = (int) wtable[1 + iw2];</span>
<span class="fc" id="L466">        na = 0;</span>
<span class="fc" id="L467">        l1 = 1;</span>
<span class="fc" id="L468">        iw = iw1;  </span>
<span class="fc bfc" id="L469" title="All 2 branches covered.">        for (k1 = 2; k1 &lt;= nf + 1; k1++) {</span>
<span class="fc" id="L470">            ip = (int) wtable[k1 + iw2];</span>
<span class="fc" id="L471">            l2 = ip * l1;</span>
<span class="fc" id="L472">            ido = n / l2;</span>
<span class="fc" id="L473">            idot = ido + ido;</span>
<span class="fc" id="L474">            idl1 = idot * l1;</span>
<span class="fc bfc" id="L475" title="All 2 branches covered.">            if (ip == 4) {</span>
<span class="fc bfc" id="L476" title="All 2 branches covered.">                if (na == 0) {</span>
<span class="fc" id="L477">                    passf4(idot, l1, c, ch, wtable, iw, isign);</span>
                } else {
<span class="fc" id="L479">                    passf4(idot, l1, ch, c, wtable, iw, isign);</span>
                }
<span class="fc" id="L481">                na = 1 - na;</span>
<span class="fc bfc" id="L482" title="All 2 branches covered.">            } else if (ip == 2) {</span>
<span class="pc bpc" id="L483" title="1 of 2 branches missed.">                if (na == 0) {</span>
<span class="fc" id="L484">                    passf2(idot, l1, c, ch, wtable, iw, isign);</span>
                } else {
<span class="nc" id="L486">                    passf2(idot, l1, ch, c, wtable, iw, isign);</span>
                }
<span class="fc" id="L488">                na = 1 - na;</span>
<span class="fc bfc" id="L489" title="All 2 branches covered.">            } else if (ip == 3) {</span>
<span class="pc bpc" id="L490" title="1 of 2 branches missed.">                if (na == 0) {</span>
<span class="fc" id="L491">                    passf3(idot, l1, c, ch, wtable, iw, isign);</span>
                } else {
<span class="nc" id="L493">                    passf3(idot, l1, ch, c, wtable, iw, isign);</span>
                }
<span class="fc" id="L495">                na = 1 - na;</span>
<span class="fc bfc" id="L496" title="All 2 branches covered.">            } else if (ip == 5) {</span>
<span class="fc bfc" id="L497" title="All 2 branches covered.">                if (na == 0) {</span>
<span class="fc" id="L498">                    passf5(idot, l1, c, ch, wtable, iw, isign);</span>
                } else {
<span class="fc" id="L500">                    passf5(idot, l1, ch, c, wtable, iw, isign);</span>
                }
<span class="fc" id="L502">                na = 1 - na;</span>
            } else {
<span class="fc bfc" id="L504" title="All 2 branches covered.">                if (na == 0) {</span>
<span class="fc" id="L505">                    passfg(nac, idot, ip, l1, idl1, c, c, c, ch, ch, wtable, iw, isign);</span>
                } else {
<span class="fc" id="L507">                    passfg(nac, idot, ip, l1, idl1, ch, ch, ch, c, c, wtable, iw, isign);</span>
                }
<span class="fc bfc" id="L509" title="All 2 branches covered.">                if (nac[0] != 0) {</span>
<span class="fc" id="L510">                    na = 1 - na;</span>
                }
            }
<span class="fc" id="L513">            l1 = l2;</span>
<span class="fc" id="L514">            iw += (ip - 1) * idot;</span>
        }
<span class="fc bfc" id="L516" title="All 2 branches covered.">        if (na == 0) {</span>
<span class="fc" id="L517">            return;</span>
        }
<span class="fc bfc" id="L519" title="All 2 branches covered.">        for (i = 0; i &lt; 2 * n; i++) {</span>
<span class="fc" id="L520">            c[i] = ch[i];</span>
        }
<span class="fc" id="L522">    }</span>

/*---------------------------------------------------------
   cfftf: Complex forward FFT
  --------------------------------------------------------*/
     void cfftf(int n, double c[], double wtable[])
     {
<span class="fc" id="L529">          cfftf1(n, c, wtable, -1);</span>
<span class="fc" id="L530">     } </span>

/*---------------------------------------------------------
   cfftb: Complex borward FFT
  --------------------------------------------------------*/
     void cfftb(int n, double c[], double wtable[])
     {
<span class="fc" id="L537">          cfftf1(n, c, wtable, +1);</span>
<span class="fc" id="L538">     } </span>

/*---------------------------------------------------------
   cffti1: further initialization of Complex FFT
  --------------------------------------------------------*/
     void cffti1(int n, double wtable[])
     {

<span class="fc" id="L546">          final int[] ntryh = {3, 4, 2, 5};</span>
<span class="fc" id="L547">          final double twopi=2.0D*Math.PI;</span>
          double  argh;
<span class="fc" id="L549">          int     idot, ntry=0, i, j;</span>
          double  argld;
          int     i1, k1, l1, l2, ib;
          double  fi;
          int     ld, ii, nf, ip, nl, nq, nr;
          double  arg;
          int     ido, ipm;

<span class="fc" id="L557">           nl=n;</span>
<span class="fc" id="L558">           nf=0;</span>
<span class="fc" id="L559">           j=0;</span>

      factorize_loop:
           while(true)
           {
<span class="fc" id="L564">               j++;</span>
<span class="fc bfc" id="L565" title="All 2 branches covered.">               if(j&lt;=4)</span>
<span class="fc" id="L566">	           ntry=ntryh[j-1];</span>
               else
<span class="fc" id="L568">	           ntry+=2;</span>
               do
               {
<span class="fc" id="L571">	            nq=nl / ntry;</span>
<span class="fc" id="L572">	            nr=nl-ntry*nq;</span>
<span class="fc bfc" id="L573" title="All 2 branches covered.">	            if(nr !=0) continue factorize_loop;</span>
<span class="fc" id="L574">	            nf++;</span>
<span class="fc" id="L575">	            wtable[nf+1+4*n]=ntry;</span>
<span class="fc" id="L576">	            nl=nq;</span>
<span class="fc bfc" id="L577" title="All 4 branches covered.">	            if(ntry==2 &amp;&amp; nf !=1)</span>
	            {
<span class="fc bfc" id="L579" title="All 2 branches covered.">	                 for(i=2; i&lt;=nf; i++)</span>
	                 {
<span class="fc" id="L581">		             ib=nf-i+2;</span>
<span class="fc" id="L582">		             wtable[ib+1+4*n]=wtable[ib+4*n];</span>
	                 }
<span class="fc" id="L584">	                 wtable[2+4*n]=2;</span>
	            }
<span class="fc bfc" id="L586" title="All 2 branches covered.">               } while(nl !=1);</span>
<span class="fc" id="L587">               break factorize_loop;</span>
           }
<span class="fc" id="L589">           wtable[0+4*n]=n;</span>
<span class="fc" id="L590">           wtable[1+4*n]=nf;</span>
<span class="fc" id="L591">           argh=twopi /(double)n;</span>
<span class="fc" id="L592">           i=1;</span>
<span class="fc" id="L593">           l1=1;</span>
<span class="fc bfc" id="L594" title="All 2 branches covered.">           for(k1=1; k1&lt;=nf; k1++)</span>
           {
<span class="fc" id="L596">	       ip=(int)wtable[k1+1+4*n];</span>
<span class="fc" id="L597">	       ld=0;</span>
<span class="fc" id="L598">	       l2=l1*ip;</span>
<span class="fc" id="L599">	       ido=n / l2;</span>
<span class="fc" id="L600">	       idot=ido+ido+2;</span>
<span class="fc" id="L601">	       ipm=ip-1;</span>
<span class="fc bfc" id="L602" title="All 2 branches covered.">	       for(j=1; j&lt;=ipm; j++)</span>
	       {
<span class="fc" id="L604">	           i1=i;</span>
<span class="fc" id="L605">	           wtable[i-1+2*n]=1;</span>
<span class="fc" id="L606">	           wtable[i+2*n]=0;</span>
<span class="fc" id="L607">	           ld+=l1;</span>
<span class="fc" id="L608">	           fi=0;</span>
<span class="fc" id="L609">	           argld=ld*argh;</span>
<span class="fc bfc" id="L610" title="All 2 branches covered.">	           for(ii=4; ii&lt;=idot; ii+=2)</span>
	           {
<span class="fc" id="L612">		       i+=2;</span>
<span class="fc" id="L613">		       fi+=1;</span>
<span class="fc" id="L614">		       arg=fi*argld;</span>
<span class="fc" id="L615">		       wtable[i-1+2*n]=Math.cos(arg);</span>
<span class="fc" id="L616">		       wtable[i+2*n]=Math.sin(arg);</span>
	           }
<span class="fc bfc" id="L618" title="All 2 branches covered.">	           if(ip&gt;5)</span>
	           {
<span class="fc" id="L620">		       wtable[i1-1+2*n]=wtable[i-1+2*n];</span>
<span class="fc" id="L621">		       wtable[i1+2*n]=wtable[i+2*n];</span>
	           }
	       }
<span class="fc" id="L624">	       l1=l2;</span>
           }

<span class="fc" id="L627">     } </span>

/*---------------------------------------------------------
   cffti:  Initialization of Real forward FFT
  --------------------------------------------------------*/
     void cffti(int n, double wtable[])
     {
<span class="pc bpc" id="L634" title="1 of 2 branches missed.">         if(n==1) return;</span>
<span class="fc" id="L635">         cffti1(n, wtable);</span>
<span class="fc" id="L636">     }	/*cffti*/</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>